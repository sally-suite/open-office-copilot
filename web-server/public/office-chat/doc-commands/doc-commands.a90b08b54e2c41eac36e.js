(function(){var __webpack_modules__={65619:function(e,t,n){"use strict";var r={};n.r(r),n.d(r,{math:function(){return Ct},menclose:function(){return Zt},mfrac:function(){return Ut},mglyph:function(){return Nt},mi:function(){return nn},mmultiscripts:function(){return Rt},mn:function(){return rn},mo:function(){return an},mover:function(){return ln},mroot:function(){return pn},mrow:function(){return Mt},ms:function(){return on},mspace:function(){return Dt},msqrt:function(){return Lt},mstyle:function(){return qt},msub:function(){return Jt},msubsup:function(){return Kt},msup:function(){return Ht},mtable:function(){return Xt},mtd:function(){return Yt},mtext:function(){return tn},mtr:function(){return Gt},munder:function(){return un},munderover:function(){return Vt},semantics:function(){return It},text:function(){return dn}});var a=n(15861),i=n(64687),o=n.n(i),s=n(4942),c=n(47509),u=n(52537),l=n(80628),p=n(41915),d=n.n(p),f=n(44925),m=n(43144),h=n(15671),g=n(98784),v=n(23401),y=n(95701),b=n(73774),w=n(48237),x=n(7774),_=n(29246),k=n(18398),O=n(29983),P=n(6853),T=n(65078),S=(n(89811),n(63825)),E=n(87363),A=n(87989),j=["duration"];function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Z=0,U=new Map,N=function(e){if(!U.has(e)){var t=setTimeout((function(){U.delete(e),L({type:"REMOVE_TOAST",toastId:e})}),1e6);U.set(e,t)}},R=function(e,t){switch(t.type){case"ADD_TOAST":return I(I({},e),{},{toasts:[t.toast].concat((0,S.Z)(e.toasts)).slice(0,1)});case"UPDATE_TOAST":return I(I({},e),{},{toasts:e.toasts.map((function(e){return e.id===t.toast.id?I(I({},e),t.toast):e}))});case"DISMISS_TOAST":var n=t.toastId;return n?N(n):e.toasts.forEach((function(e){N(e.id)})),I(I({},e),{},{toasts:e.toasts.map((function(e){return e.id===n||void 0===n?I(I({},e),{},{open:!1}):e}))});case"REMOVE_TOAST":return void 0===t.toastId?I(I({},e),{},{toasts:[]}):I(I({},e),{},{toasts:e.toasts.filter((function(e){return e.id!==t.toastId}))})}},M=[],D={toasts:[]};function L(e){D=R(D,e),M.forEach((function(e){e(D)}))}function q(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2e4;!function(e){var t=e.duration,n=void 0===t?2e3:t,r=(0,c.Z)(e,j),a=(Z=(Z+1)%Number.MAX_SAFE_INTEGER).toString(),i=function(){return L({type:"DISMISS_TOAST",toastId:a})};L({type:"ADD_TOAST",toast:I(I({},r),{},{id:a,open:!0,onOpenChange:function(e){e||i()}})}),n&&setTimeout((function(){i()}),n)}({title:"",description:E.createElement("div",{className:"flex flex-row items-center"},E.createElement(A.bG7,{className:"text-red-400"}),E.createElement("span",{className:"ml-1"},e)),duration:t})}var F="gpt-4o-mini",B="ai_model",$="ai_provider",z="model_api_key",W="model_api_base_url",J="ai_model_config",K={cache:new Map,getItem:function(e){return this.cache.get(e)},setItem:function(e,t){this.cache.set(e,t)},removeItem:function(e){this.cache.delete(e)}},H=function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=window.localStorage;a||(a=window.sessionStorage),a||(a=K),null==r||void 0===r||""==r?null===(t=a)||void 0===t||t.removeItem(e):null===(n=a)||void 0===n||n.setItem(e,JSON.stringify(r))},X=function(e){var t,n=window.localStorage;n||(n=window.sessionStorage),n||(n=K);var r=null===(t=n)||void 0===t?void 0:t.getItem(e);try{return r?JSON.parse(r):void 0}catch(e){return}},Y=function(){var e=(0,l.Z)(d().mark((function e(){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",X("user-token")||"");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),G=function(){var e=(0,l.Z)(d().mark((function e(){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",X(B)||F);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();function V(e,t){return Q.apply(this,arguments)}function Q(){return Q=(0,l.Z)(d().mark((function e(t,n){var r,a,i,o,s,c;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t||X(B)||F,a=n||X($)||"",i=a?"".concat(z,"_").concat(r,"_").concat(a):"".concat(z,"_").concat(r),o=a?"".concat(W,"_").concat(r,"_").concat(a):"".concat(W,"_").concat(r),s=X(o),c=function(){var e=(0,l.Z)(d().mark((function e(){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:H(i,""),H(o,"");case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e.abrupt("return",{model:r,apiKey:"default",apiHost:s,clear:c});case 7:case"end":return e.stop()}}),e)}))),Q.apply(this,arguments)}var ee=function(){var e=(0,l.Z)(d().mark((function e(){var t,n,r,a,i,o,s,c;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,X(J);case 2:if(!(t=e.sent)){e.next=9;break}return e.next=6,te(t);case 6:if(!(n=e.sent)){e.next=9;break}return e.abrupt("return",n);case 9:if(r=X(B)||F,a=X($)||"",i=a?"".concat(z,"_").concat(r,"_").concat(a):"".concat(z,"_").concat(r),o=a?"".concat(W,"_").concat(r,"_").concat(a):"".concat(W,"_").concat(r),s=X(o),!(c=X(i))){e.next=17;break}return e.abrupt("return",{id:"",model:r,provider:a,apiKey:c,baseUrl:s,custom:!1});case 17:return e.abrupt("return",{id:"",model:"gpt-4o-mini",provider:"",apiKey:"",baseUrl:"",custom:!1});case 18:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),te=function(){var e=(0,l.Z)(d().mark((function e(t){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",X("".concat(J,"_").concat(t)));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ne=["parseChunk"],re=["parseChunk"];function ae(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ie(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ae(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ae(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function oe(e){var t,n,r,a=2;for("undefined"!=typeof Symbol&&(n=Symbol.asyncIterator,r=Symbol.iterator);a--;){if(n&&null!=(t=e[n]))return t.call(e);if(r&&null!=(t=e[r]))return new se(t.call(e));n="@@asyncIterator",r="@@iterator"}throw new TypeError("Object is not async iterable")}function se(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then((function(e){return{value:e,done:t}}))}return se=function(e){this.s=e,this.n=e.next},se.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var n=this.s.return;return void 0===n?Promise.resolve({value:e,done:!0}):t(n.apply(this.s,arguments))},throw:function(e){var n=this.s.return;return void 0===n?Promise.reject(e):t(n.apply(this.s,arguments))}},new se(e)}var ce=function(e){(0,x.Z)(a,e);var t,n,r=(t=a,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,k.Z)(t);if(n){var a=(0,k.Z)(this).constructor;e=Reflect.construct(r,arguments,a)}else e=r.apply(this,arguments);return(0,_.Z)(this,e)});function a(e,t){var n;return(0,b.Z)(this,a),n=r.call(this,e),(0,u.Z)((0,w.Z)(n),"code",void 0),n.code=t,n}return(0,y.Z)(a)}((0,O.Z)(Error));function ue(e){try{return JSON.parse(e)}catch(t){return e}}function le(e){return pe.apply(this,arguments)}function pe(){return(pe=(0,T.Z)(d().mark((function e(t){var n,r,a,i,o,s,c,u,l;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new TextDecoder("utf-8"),e.next=3,(0,P.Z)(t.read());case 3:r=e.sent,a=r.value,i=r.done,a=a?n.decode(a,{stream:!0}):"",o=/\r\n|\n|\r/gm,s=0;case 9:if(c=o.exec(a)){e.next=22;break}if(!i){e.next=13;break}return e.abrupt("break",27);case 13:return u=a.substr(s),e.next=16,(0,P.Z)(t.read());case 16:return l=e.sent,a=l.value,i=l.done,a=u+(a?n.decode(a,{stream:!0}):""),s=o.lastIndex=0,e.abrupt("continue",25);case 22:return e.next=24,a.substring(s,c.index);case 24:s=o.lastIndex;case 25:e.next=9;break;case 27:if(!(s<a.length)){e.next=30;break}return e.next=30,a.substr(s);case 30:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var de=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,b.Z)(this,e),(0,u.Z)(this,"defaultConfig",{}),(0,u.Z)(this,"baseUrl",void 0),(0,u.Z)(this,"token",void 0),this.defaultConfig=t}var t,n,r,a;return(0,y.Z)(e,[{key:"prepareConfig",value:(a=(0,l.Z)(d().mark((function e(t,n){var r,a;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=ie(ie(ie({},this.defaultConfig),n),{},{headers:ie(ie({},this.defaultConfig.headers),n.headers)}),a=t,t.startsWith("http")||(a=this.baseUrl?this.baseUrl+t:t),e.next=5,Y();case 5:return this.token=e.sent,this.token&&(r.headers=ie({Authorization:"Bearer ".concat(this.token)},r.headers)),e.abrupt("return",{url:a,config:r});case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"interceptFetch",value:(r=(0,l.Z)(d().mark((function e(t,n){var r,a,i,o,s;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.prepareConfig(t,n);case 3:return r=e.sent,a=r.url,i=r.config,e.next=8,fetch(a,i);case 8:if((o=e.sent).ok){e.next=11;break}throw new ce("Request failed with status ".concat(o.status," ").concat(o.statusText),o.status);case 11:return e.next=13,o.json();case 13:if(s=e.sent,!Object.prototype.hasOwnProperty.call(s,"code")){e.next=20;break}if(0!=s.code){e.next=19;break}return e.abrupt("return",s.data);case 19:throw new ce(s.message,s.code);case 20:return e.abrupt("return",s);case 23:throw e.prev=23,e.t0=e.catch(0),console.log(t,e.t0),console.error("Request failed:",e.t0.message),e.t0;case 28:case"end":return e.stop()}}),e,this,[[0,23]])}))),function(e,t){return r.apply(this,arguments)})},{key:"interceptFetchByStreamLine",value:(n=(0,l.Z)(d().mark((function e(t,n,r){var a,i,o,s,u,l,p,f,m,h,g,v,y,b,w,x,_,k;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.prepareConfig(t,n);case 2:return a=e.sent,i=a.url,o=a.config,e.prev=5,(s=o).parseChunk,u=(0,c.Z)(s,ne),l=new AbortController,window.abort=function(){l.abort()},e.next=11,fetch(i,ie(ie({},u),{},{method:"POST",signal:l.signal}));case 11:if((p=e.sent).ok){e.next=14;break}throw new ce("Request failed with status ".concat(p.status),p.status);case 14:f=p.body,m=f.getReader(),h=!1,g=function(){h=!0,l.abort()},v=[],y=!1,b=!1,e.prev=21,x=oe(le(m));case 23:return e.next=25,x.next();case 25:if(!(y=!(_=e.sent).done)){e.next=34;break}if(k=_.value,v.push(k),!r){e.next=31;break}return e.next=31,r(h,k,(function(){g()}));case 31:y=!1,e.next=23;break;case 34:e.next=40;break;case 36:e.prev=36,e.t0=e.catch(21),b=!0,w=e.t0;case 40:if(e.prev=40,e.prev=41,!y||null==x.return){e.next=45;break}return e.next=45,x.return();case 45:if(e.prev=45,!b){e.next=48;break}throw w;case 48:return e.finish(45);case 49:return e.finish(40);case 50:if(!r){e.next=53;break}return e.next=53,r(!0,"",(function(){g()}));case 53:return e.abrupt("return",v);case 56:throw e.prev=56,e.t1=e.catch(5),console.error("Request failed:",e.t1),console.log(e.t1.stack),e.t1;case 61:case"end":return e.stop()}}),e,this,[[5,56],[21,36,40,50],[41,,45,49]])}))),function(e,t,r){return n.apply(this,arguments)})},{key:"interceptFetchByStream",value:(t=(0,l.Z)(d().mark((function e(t,n,r){var a,i,o,s,u,l,p,f,m,h,g,y,b,w,x,_,k,O,P;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.prepareConfig(t,n);case 2:return a=e.sent,i=a.url,o=a.config,e.prev=5,u=(s=o).parseChunk,l=(0,c.Z)(s,re),p=new AbortController,window.abort=function(){p.abort()},e.next=11,fetch(i,ie(ie({},l),{},{method:"POST",signal:p.signal}));case 11:if((f=e.sent).ok){e.next=14;break}throw new ce("Request failed with status ".concat(f.status," ").concat(f.statusText),f.status);case 14:m=f.body,h=m.getReader(),g=new TextDecoder,y=!1,b=function(){y=!0,p.abort()},w="";case 20:if(y){e.next=35;break}return e.next=23,h.read();case 23:if(x=e.sent,_=x.value,k=x.done,y=k,O=g.decode(_),u&&(O=u(O)),w+=O,!r){e.next=33;break}return e.next=33,r(y,w,(function(){b()}));case 33:e.next=20;break;case 35:if("string"!=typeof(P=ue(w))){e.next=40;break}return e.abrupt("return",P);case 40:if("object"!==(0,v.Z)(P)){e.next=50;break}if(0!=P.code){e.next=45;break}return e.abrupt("return",P.data);case 45:if(-1!=P.code){e.next=49;break}throw new ce(P.message,P.code);case 49:return e.abrupt("return",P);case 50:e.next=57;break;case 52:throw e.prev=52,e.t0=e.catch(5),console.error("Request failed:",e.t0),console.log(e.t0.stack),e.t0;case 57:case"end":return e.stop()}}),e,this,[[5,52]])}))),function(e,n,r){return t.apply(this,arguments)})},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.interceptFetch(e,ie({method:"GET"},t))}},{key:"post",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.interceptFetch(e,ie({method:"POST",body:JSON.stringify(t)},n))}},{key:"stream",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0;return this.interceptFetchByStream(e,ie({method:"POST",body:JSON.stringify(t)},n),r)}},{key:"streamLine",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0;return this.interceptFetchByStreamLine(e,ie({method:"POST",body:JSON.stringify(t)},n),r)}},{key:"fetch",value:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=(0,l.Z)(d().mark((function e(t,n){var r,a,i,o;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.prepareConfig(t,n);case 3:return r=e.sent,a=r.url,i=r.config,e.next=8,fetch(a,ie(ie({},i),{},{method:"POST"}));case 8:if((o=e.sent).ok){e.next=11;break}throw new ce("Request failed with status ".concat(o.status," ").concat(o.statusText),o.status);case 11:return e.abrupt("return",o);case 14:throw e.prev=14,e.t0=e.catch(0),console.log(t,e.t0),console.error("Request failed:",e.t0.message),q(e.t0.message),e.t0;case 20:case"end":return e.stop()}}),e,this,[[0,14]])})));return function(t,n){return e.apply(this,arguments)}}())}]),e}(),fe=new de({headers:{"Content-Type":"application/json"}});fe.baseUrl="";var me=fe;function he(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ge(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?he(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):he(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ve=function(e){var t=e,n="GET",r=e.split(" ");return 2===r.length&&(n=r[0],t=r[1]),t.startsWith("http")||(t="/api"+t),function(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0,o=t;if("GET"===n){if(e){var s=function(e){var t=new URLSearchParams;for(var n in e)t.append(n,e[n]);return t.toString()}(e);o="".concat(t,"?").concat(s)}}else e&&(r=JSON.stringify(e));return"STREAM"===n?me.interceptFetchByStream(o,ge(ge({},a),{},{body:r,method:n}),i):"STREAMLINE"===n?me.interceptFetchByStreamLine(o,ge(ge({},a),{},{body:r,method:n}),i):"PROXY"===n?me.fetch(o,ge(ge({},a),{},{body:r,method:n})):me.interceptFetch(o,ge(ge({},a),{},{body:r,method:n}))}},ye={login:"POST /auth/login",getMessages:"GET /message/get_messages",sentMessage:"POST /message/sent_message",chat:"POST /chat_proxy",chatStreamLine:"STREAMLINE /chat_proxy",embeddings:"POST /embeddings",completions:"POST /completions",speechToText:"POST /speech_to_text",setUserProperty:"POST /user/set_property",getUserProperty:"POST /user/get_property",checkUser:"POST /user/check_state",getAgent:"POST /agent/get_agent",getAgents:"POST /agent/get_agents",addAgent:"POST /agent/add_agent",updateAgent:"POST /agent/update_agent",getPoints:"POST /user/get_points",search:"POST /search/web_pages",searchImages:"POST /search/images",generateImages:"POST /images/generations",getModels:"POST /models/get_models",addModel:"POST /models/add_model",removeModel:"POST /models/remove_model",addPlan:"POST /plans/add_plan",getPlan:"POST /plans/get_plan",getPlanList:"POST /plans/get_plans",removePlan:"POST /plans/remove_plan",imageProxy:"PROXY /images/proxy",addBookmark:"POST /bookmark/add_bookmark",getBookmarkList:"POST /bookmark/get_bookmarks",removeBookmark:"POST /bookmark/remove_bookmark",searchPapers:"POST /search/scholar/search_papers",searchScholar:"POST /search/scholar/search_scholar",getCitation:"POST /search/scholar/get_citation",getProviderModels:"POST /models/get_provider_models",getUserPrompts:"POST /prompts/get_prompts",addUserPrompt:"POST /prompts/add_prompt",removeUserPrompt:"POST /prompts/remove_prompt"},be={};for(var we in ye)be[we]=ve(ye[we]);var xe=be;function _e(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return new Promise((function(n){var r,a,i=document.createElement("canvas"),o=i.getContext("2d"),s=new Image,c=800,u=600;if(e.getBoundingClientRect){var l=e.getBoundingClientRect();console.log(l),c=l.width,u=l.height}null==e||null===(r=e.setAttribute)||void 0===r||r.call(e,"width",c+""),null==e||null===(a=e.setAttribute)||void 0===a||a.call(e,"height",u+""),s.width=i.width=c*t,s.height=i.height=u*t,s.onload=function(){o.drawImage(s,0,0,s.width,s.height),n({width:s.width,height:s.height,data:i.toDataURL()})};var p=(new XMLSerializer).serializeToString(e);s.src="data:image/svg+xml,"+encodeURIComponent(p)}))}var ke=n(38147),Oe=n(58754),Pe=n(58028),Te=n(71482),Se=n(87057),Ee=n(63779),Ae=n(86610),je=n(77802),Ce=n(41981),Ie=n(38316),Ze=n.n(Ie),Ue=n(98905);function Ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ne(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}n(56045).o.initialize({theme:"neutral",startOnLoad:!1});var Me=function(){return function(){var e=(0,l.Z)(d().mark((function e(t){var n;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],Ze()(t,"element",(function(e){"svg"===e.tagName&&n.push((0,l.Z)(d().mark((function t(){var n,r,a,i,o,s;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,console.log("node",e),n=(0,Ue.v)(e),console.log("svgString",n),(r=document.createElement("div")).style.position="fixed",r.style.left="-2000px",r.style.top="-2000px",r.style.width="800px",r.innerHTML=n,document.body.appendChild(r),t.next=13,_e(r.childNodes[0]);case 13:a=t.sent,i=a.width,o=a.height,s=a.data,console.log(i,o,s),document.body.removeChild(r),e.tagName="img",e.properties=Re(Re({},e.properties),{},{src:s,width:"".concat(i,"px"),height:"".concat(o,"px"),alt:"Mermaid diagram"}),e.children=[],t.next=27;break;case 24:t.prev=24,t.t0=t.catch(0),console.error("Error converting SVG to PNG:",t.t0);case 27:case"end":return t.stop()}}),t,null,[[0,24]])})))())})),e.next=4,Promise.all(n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},De=function(){return function(e){Ze()(e,"raw",(function(e){e.type="html"}))}},Le=function(){var e=(0,l.Z)(d().mark((function e(t){var n=arguments;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n.length>1&&void 0!==n[1]&&n[1])){e.next=5;break}return e.next=4,Fe(t);case 4:case 7:return e.abrupt("return",e.sent);case 5:return e.next=7,qe(t);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),qe=function(){var e=(0,l.Z)(d().mark((function e(t){var n;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,Ce.l)().use(Oe.Z).use(je.Z).use(Te.Z).use(Ee.Z).use(De).use(Pe.Z,{allowDangerousHtml:!0,allowDangerousCharacters:!0}).use(Ae.Z).use(Me).use(ke.Z,{allowDangerousHtml:!0,allowDangerousCharacters:!0}).process(t);case 2:return n=e.sent,e.abrupt("return",String(n));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Fe=function(){var e=(0,l.Z)(d().mark((function e(t){var n,r,a;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,Ce.l)().use(Oe.Z).use(je.Z).use(Te.Z).use(Ee.Z).use(Pe.Z,{allowDangerousHtml:!0}).use(Se.Z).use(Me).use(ke.Z),e.next=3,n.process(t);case 3:return r=e.sent,a=r.value,e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Be=function(){function e(){(0,b.Z)(this,e),(0,u.Z)(this,"processedParagraphsCount",0),(0,u.Z)(this,"buffer",""),(0,u.Z)(this,"paragraphDelimiter",/\n\s*\n/)}var t,n;return(0,y.Z)(e,[{key:"processStream",value:(n=(0,l.Z)(d().mark((function e(t){var n,r,a;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.buffer+=t,n=this.buffer.split(this.paragraphDelimiter),r=n.pop()||"",e.next=5,Promise.all(n.slice(this.processedParagraphsCount));case 5:return a=e.sent,this.processedParagraphsCount=n.length,this.buffer=r,e.abrupt("return",{newParagraphs:a,remainingBuffer:r});case 9:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"finalize",value:(t=(0,l.Z)(d().mark((function e(){var t;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.buffer){e.next=2;break}return e.abrupt("return",[]);case 2:return t=this.buffer.trim(),this.buffer="",this.processedParagraphsCount=0,e.abrupt("return",[t]);case 6:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}();function $e(e){var t,n,r,a=2;for("undefined"!=typeof Symbol&&(n=Symbol.asyncIterator,r=Symbol.iterator);a--;){if(n&&null!=(t=e[n]))return t.call(e);if(r&&null!=(t=e[r]))return new ze(t.call(e));n="@@asyncIterator",r="@@iterator"}throw new TypeError("Object is not async iterable")}function ze(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then((function(e){return{value:e,done:t}}))}return ze=function(e){this.s=e,this.n=e.next},ze.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var n=this.s.return;return void 0===n?Promise.resolve({value:e,done:!0}):t(n.apply(this.s,arguments))},throw:function(e){var n=this.s.return;return void 0===n?Promise.reject(e):t(n.apply(this.s,arguments))}},new ze(e)}var We=function(e){(0,x.Z)(a,e);var t,n,r=(t=a,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,k.Z)(t);if(n){var a=(0,k.Z)(this).constructor;e=Reflect.construct(r,arguments,a)}else e=r.apply(this,arguments);return(0,_.Z)(this,e)});function a(e,t){var n;return(0,b.Z)(this,a),n=r.call(this,e),(0,u.Z)((0,w.Z)(n),"code",void 0),n.code=t,n}return(0,y.Z)(a)}((0,O.Z)(Error));function Je(e){return Ke.apply(this,arguments)}function Ke(){return(Ke=(0,T.Z)(d().mark((function e(t){var n,r,a,i,o,s,c,u,l;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new TextDecoder("utf-8"),e.next=3,(0,P.Z)(t.read());case 3:r=e.sent,a=r.value,i=r.done,a=a?n.decode(a,{stream:!0}):"",o=/\r\n|\n|\r/gm,s=0;case 9:if(c=o.exec(a)){e.next=22;break}if(!i){e.next=13;break}return e.abrupt("break",27);case 13:return u=a.substr(s),e.next=16,(0,P.Z)(t.read());case 16:return l=e.sent,a=l.value,i=l.done,a=u+(a?n.decode(a,{stream:!0}):""),s=o.lastIndex=0,e.abrupt("continue",25);case 22:return e.next=24,a.substring(s,c.index);case 24:s=o.lastIndex;case 25:e.next=9;break;case 27:if(!(s<a.length)){e.next=30;break}return e.next=30,a.substr(s);case 30:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function He(e,t){return t.length<=0||t.forEach((function(t){var n=e.findIndex((function(e){return e.index===t.index}));if(-1!==n){var r=e[n];Object.keys(t.function).forEach((function(e){r.function[e]+=t.function[e]})),Object.keys(t).forEach((function(e){"function"!==e&&(r[e]=t[e])}))}else e.push(t)})),e}var Xe=function(){var e=(0,l.Z)(d().mark((function e(t){var n,r,a,i,o,s;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ee();case 2:return n=e.sent,r=n.apiKey,a=n.baseUrl,i=r,e.next=8,fetch("".concat(a,"/chat/completions"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(i),"HTTP-Referer":"https://www.sally.bot","X-Title":"Sally"},body:JSON.stringify(t)});case 8:if((o=e.sent).ok){e.next=12;break}throw q("Request failed with status ".concat(o.status," ").concat(o.statusText)),new We("Request failed with status ".concat(o.status," ").concat(o.statusText),o.status);case 12:return e.next=14,o.json();case 14:return s=e.sent,e.abrupt("return",s);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ye=function(){var e=(0,l.Z)(d().mark((function e(t,n){var r,a,i,o,s,c,u,l,p,f,m,h,g,v,y,b,w,x,_,k,O,P,T,S,E,A,j;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ee();case 2:return r=e.sent,a=r.apiKey,i=r.baseUrl,o=a,e.prev=6,s=new AbortController,e.next=10,fetch("".concat(i,"/chat/completions"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(o),"HTTP-Referer":"https://www.sally.bot","X-Title":"Sally"},body:JSON.stringify(t),signal:s.signal});case 10:if((c=e.sent).ok){e.next=14;break}throw q("Request failed with status ".concat(c.status," ").concat(c.statusText)),new We("Request failed with status ".concat(c.status," ").concat(c.statusText),c.status);case 14:u=c.body,l=u.getReader(),p=!1,f=function(){p=!0,s.abort()},m={content:"",reasoning_content:"",delta:{content:"",reasoning_content:""},tool_calls:[]},h=[],g=!1,v=!1,e.prev=22,b=$e(Je(l));case 24:return e.next=26,b.next();case 26:if(!(g=!(w=e.sent).done)){e.next=54;break}if((x=w.value).startsWith("data:")){e.next=30;break}return e.abrupt("continue",51);case 30:if(h.push(x),x&&!x.includes("[DONE]")){e.next=33;break}return e.abrupt("continue",51);case 33:if(_=x.replace(/^data:/,""),!((k=JSON.parse(_)).choices&&k.choices.length>0)){e.next=45;break}S=k.choices[0],E=null===(O=S.delta)||void 0===O?void 0:O.content,A=null===(P=S.delta)||void 0===P?void 0:P.reasoning_content,j=null===(T=S.delta)||void 0===T?void 0:T.tool_calls,void 0!==A&&null!=A?(m.reasoning_content+=A,m.delta.reasoning_content=A):m.delta.reasoning_content="",void 0!==E&&null!=E?(m.content+=E,m.delta.content=E):m.delta.content="",null!=j&&(m.tool_calls=He(m.tool_calls,j)),e.next=48;break;case 45:if(!k.error){e.next=48;break}throw q(k.error.message),new Error(JSON.stringify(k.error,null,2));case 48:if(!n||!m){e.next=51;break}return e.next=51,n(p,m,(function(){f()}));case 51:g=!1,e.next=24;break;case 54:e.next=60;break;case 56:e.prev=56,e.t0=e.catch(22),v=!0,y=e.t0;case 60:if(e.prev=60,e.prev=61,!g||null==b.return){e.next=65;break}return e.next=65,b.return();case 65:if(e.prev=65,!v){e.next=68;break}throw y;case 68:return e.finish(65);case 69:return e.finish(60);case 70:if(!n){e.next=73;break}return e.next=73,n(!0,"",(function(){f()}));case 73:return e.abrupt("return",m);case 76:throw e.prev=76,e.t1=e.catch(6),console.error("Request failed:",e.t1),console.log(e.t1.stack),e.t1;case 81:case"end":return e.stop()}}),e,null,[[6,76],[22,56,60,70],[61,,65,69]])})));return function(t,n){return e.apply(this,arguments)}}(),Ge=function(){var e=(0,l.Z)(d().mark((function e(t){var n,r,a,i,o,s;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ee();case 2:return n=e.sent,r=n.apiKey,a=n.baseUrl,i=r,e.next=8,fetch("".concat(a,"/embeddings"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(i),"HTTP-Referer":"https://www.sally.bot","X-Title":"Sally"},body:JSON.stringify(t)});case 8:if((o=e.sent).ok){e.next=13;break}throw new We("Request failed with status ".concat(o.status," ").concat(o.statusText),o.status);case 13:return e.next=15,o.json();case 15:return s=e.sent,e.abrupt("return",s.data[0].embedding);case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ve=function(){var e=(0,l.Z)(d().mark((function e(t){var n,r,a,i,o,s;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ee();case 2:return n=e.sent,r=n.apiKey,a=n.baseUrl,i=r,e.next=8,fetch("".concat(a,"/images/generations"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(i),"HTTP-Referer":"https://www.sally.bot","X-Title":"Sally"},body:JSON.stringify(t)});case 8:return o=e.sent,e.next=11,o.json();case 11:return s=e.sent,e.abrupt("return",s);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Qe=["messages","temperature","stream"],et=["agent","messages","temperature","stream"];function tt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function nt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tt(Object(n),!0).forEach((function(t){(0,s.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var rt=(0,m.Z)((function e(){(0,h.Z)(this,e),(0,s.Z)(this,"embeddings",function(){var e=(0,a.Z)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ee();case 2:if(e.sent.apiKey){e.next=10;break}if(!Y()){e.next=10;break}return e.next=9,xe.embeddings(t);case 9:case 12:return e.abrupt("return",e.sent);case 10:return e.next=12,Ge(t);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),(0,s.Z)(this,"speechToText",function(){var e=(0,a.Z)(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,xe.speechToText({audio:t});case 2:return n=e.sent,(0,g.BB)()||console.log("speechToText output",n),e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),(0,s.Z)(this,"chat",function(){var e=(0,a.Z)(o().mark((function e(t,n){var r,i,s,c,u,l,p,d,m,h,g,v,y,b,w,x,_,k,O,P;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ee();case 2:if(e.sent.apiKey){e.next=22;break}if(r=t.messages,i=void 0===r?[]:r,s=t.temperature,c=void 0===s?0:s,u=t.stream,l=(0,f.Z)(t,Qe),u){e.next=17;break}return e.next=9,xe.chat(nt({messages:i,temperature:c},l));case 9:if(p=e.sent,d=p.choices.length>0?p.choices[0].message:{content:""},!n||!d){e.next=14;break}return e.next=14,n(!0,d,null);case 14:return e.abrupt("return",d);case 17:return m={content:"",reasoning_content:"",delta:{reasoning_content:"",content:""},tool_calls:[]},h="",e.next=21,xe.chatStreamLine(nt({messages:i,temperature:c,stream:u},l),{},function(){var e=(0,a.Z)(o().mark((function e(t,r,a){var i,s,c,u,l,p,d,f,g,v,y,b;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=2;break}return e.abrupt("return",n(t,m,a));case 2:if(r&&!r.includes("[DONE]")){e.next=4;break}return e.abrupt("return");case 4:i=r.replace(/^data:/,""),e.prev=5,s=JSON.parse(h+i),h="",e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(5),h=i,e.abrupt("return");case 14:if(!(s.choices&&s.choices.length>0)){e.next=22;break}d=s.choices[0],null!==(c=d.delta)&&void 0!==c&&c.reasoning_content?(m.reasoning_content+=null===(f=d.delta)||void 0===f?void 0:f.reasoning_content,m.delta.reasoning_content=null===(g=d.delta)||void 0===g?void 0:g.reasoning_content):m.delta.reasoning_content="",null!==(u=d.delta)&&void 0!==u&&u.content?(m.content+=null===(v=d.delta)||void 0===v?void 0:v.content,m.delta.content=null===(y=d.delta)||void 0===y?void 0:y.content):m.delta.content="",null!=(b=(null===(l=d.delta)||void 0===l?void 0:l.toolCalls)||(null===(p=d.delta)||void 0===p?void 0:p.tool_calls))&&(m.tool_calls=He(m.tool_calls,b)),e.next=25;break;case 22:if(!s.error){e.next=25;break}throw q(s.error.message),new Error(JSON.stringify(s.error,null,2));case 25:if(!n||!m){e.next=28;break}return e.next=28,n(t,m,a);case 28:case"end":return e.stop()}}),e,null,[[5,10]])})));return function(t,n,r){return e.apply(this,arguments)}}());case 21:return e.abrupt("return",m);case 22:if(t.agent,g=t.messages,v=void 0===g?[]:g,y=t.temperature,b=void 0===y?0:y,w=t.stream,x=void 0!==w&&w,_=(0,f.Z)(t,et),x){e.next=34;break}return e.next=26,Xe(nt({messages:v,temperature:b},_));case 26:if(k=e.sent,O=k.choices.length>0?k.choices[0].message:{content:""},!n||!O){e.next=31;break}return e.next=31,n(!0,O,null);case 31:return e.abrupt("return",O);case 34:return P={content:"",tool_calls:[]},e.next=37,Ye(nt({messages:v,temperature:b,stream:x},_),function(){var e=(0,a.Z)(o().mark((function e(t,r,a){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return");case 2:if(P=r,!n||!r){e.next=6;break}return e.next=6,n(t,r,a);case 6:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}());case 37:if(!n||!P){e.next=40;break}return e.next=40,n(!0,P,stop);case 40:return e.abrupt("return",P);case 41:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),(0,s.Z)(this,"generateImages",function(){var e=(0,a.Z)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ee();case 2:if(e.sent.apiKey){e.next=6;break}return e.abrupt("return",xe.generateImages(t));case 6:return e.abrupt("return",Ve(t));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),(0,s.Z)(this,"addModel",(function(e){return xe.addModel(e)})),(0,s.Z)(this,"getModels",(function(){return xe.getModels({})})),(0,s.Z)(this,"removeModel",(function(e){return xe.removeModel({id:e})}))})),at=new rt,it=["model","messages","tools","temperature"],ot=["model","messages","temperature","tools"];function st(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ct(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?st(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):st(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ut=function(){var e=(0,l.Z)(d().mark((function e(t,n){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.stream){e.next=5;break}return e.abrupt("return",lt(t));case 5:return e.abrupt("return",pt(t,n));case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),lt=function(){var e=(0,l.Z)(d().mark((function e(t){var n,r,a,i,o,s,u,l,p;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.model,r=t.messages,a=void 0===r?[]:r,i=t.tools,o=t.temperature,s=void 0===o?.5:o,u=(0,c.Z)(t,it),l=n){e.next=6;break}return e.next=5,G();case 5:l=e.sent;case 6:return e.next=8,at.chat(ct({model:l,messages:a,temperature:s,tools:i&&i.length>0?i:void 0},u));case 8:if(p=e.sent,!(t.functions&&t.functions.length>0)){e.next=12;break}if(!p.function_call){e.next=12;break}return e.abrupt("return",{content:p.content,function_call:p.function_call});case 12:if(!(t.tools&&t.tools.length>0)){e.next=15;break}if(!p.tools){e.next=15;break}return e.abrupt("return",{content:p.content,tool_calls:p.tool_calls});case 15:return e.abrupt("return",p);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),pt=function(){var e=(0,l.Z)(d().mark((function e(t,n){var r,a,i,o,s,u,l,p,f;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.model,a=t.messages,i=void 0===a?[]:a,o=t.temperature,s=void 0===o?.5:o,u=t.tools,l=(0,c.Z)(t,ot),p=r){e.next=6;break}return e.next=5,G();case 5:p=e.sent;case 6:return e.next=8,at.chat(ct({model:p,messages:i,temperature:s,tools:u&&u.length>0?u:void 0},l),n);case 8:return f=e.sent,e.abrupt("return",f);case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();function dt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ft(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?dt(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var mt,ht,gt=(ht=(mt=n(58695)).keys().reduce((function(e,t){var n=mt(t);if(t.endsWith(".md")){var r=t.replace("./","").replace(".md","").split("/")[1];return ft(ft({},e),{},(0,u.Z)({},r,n.default))}}),{}),ht),vt=gt;function yt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function bt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?yt(Object(n),!0).forEach((function(t){(0,s.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var wt=function(){var e=(0,a.Z)(o().mark((function e(t,n){var r,a,i,s,c,u=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=u.length>2&&void 0!==u[2]?u[2]:{temperature:.8,stream:!0},a=u.length>3?u[3]:void 0,i=vt[t],s=(0,g.XK)(i,{input:n}),n){e.next=6;break}throw new Error("Please select text");case 6:return e.next=8,ut(bt({temperature:.8,messages:[{role:"user",content:s}]},r),a);case 8:return c=e.sent,e.abrupt("return",null==c?void 0:c.content);case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),xt=n(15785),_t=n(41008),kt=n(26084),Ot=/\s([^'"/\s><]+?)[\s/>]|([^\s=]+)=\s?(".*?"|'.*?')/g;function Pt(e){var t={type:"tag",name:"",voidElement:!1,attribs:{},children:[]},n=e.match(/<\/?([^\s]+?)[/\s>]/);if(n&&(t.name=n[1],"/"===e.charAt(e.length-2)&&(t.voidElement=!0),t.name.startsWith("!--"))){var r=e.indexOf("--\x3e");return{type:"comment",comment:-1!==r?e.slice(4,r):""}}for(var a=new RegExp(Ot),i=null;null!==(i=a.exec(e));)if(i[0].trim())if(i[1]){var o=i[1].trim(),s=[o,""];o.indexOf("=")>-1&&(s=o.split("=")),t.attribs[s[0]]=s[1],a.lastIndex--}else i[2]&&(t.attribs[i[2]]=i[3].trim().substring(1,i[3].length-1));return t}var Tt=/<[a-zA-Z0-9\-!/](?:"[^"]*"|'[^']*'|[^'">])*>/g,St=/^\s*$/,Et=["mtext","mi","mn","mo","ms"],At=Object.create(null);function jt(e,t){switch(t.type){case"text":return e+t.data;case"tag":var n=t.voidElement||!t.children.length&&"preserve"!==t.attribs["xml:space"];return e+="<"+t.name+(t.attribs?function(e){var t=[];for(var n in e)t.push(n+'="'+e[n]+'"');return t.length?" "+t.join(" "):""}(t.attribs):"")+(n?"/>":">"),n?e:e+t.children.reduce(jt,"")+"</"+t.name+">";case"comment":return e+"\x3c!--"+t.comment+"--\x3e"}}function Ct(e,t,n,r,a){return t.name="m:oMath",t.attribs={"xmlns:m":"http://schemas.openxmlformats.org/officeDocument/2006/math"},t.type="tag",t.children=[],t}function It(e,t,n,r,a){return t}function Zt(e,t,n,r,a){var i,o=(null===(i=e.attribs)||void 0===i||null===(i=i.notation)||void 0===i?void 0:i.split(" ")[0])||"longdiv",s={type:"tag",name:"m:e",attribs:{},children:[]};if("longdiv"===o)t.children.push({type:"tag",name:"m:rad",attribs:{},children:[{type:"tag",name:"m:radPr",attribs:{},children:[{type:"tag",name:"m:degHide",attribs:{"m:val":"on"},children:[]}]},{type:"tag",name:"m:deg",attribs:{},children:[]},s]});else{var c={t:{type:"tag",name:"m:hideTop",attribs:{"m:val":"on"},children:[]},b:{type:"tag",name:"m:hideBot",attribs:{"m:val":"on"},children:[]},l:{type:"tag",name:"m:hideLeft",attribs:{"m:val":"on"},children:[]},r:{type:"tag",name:"m:hideRight",attribs:{"m:val":"on"},children:[]}},u={type:"tag",name:"m:borderBoxPr",attribs:{},children:[]},l={type:"tag",name:"m:borderBox",attribs:{},children:[]};switch(o){case"actuarial":case"radical":case"box":l.children=[s];break;case"left":case"roundedbox":u.children=[c.t,c.b,c.r],l.children=[u,s];break;case"right":case"circle":u.children=[c.t,c.b,c.l],l.children=[u,s];break;case"top":u.children=[c.b,c.l,c.r],l.children=[u,s];break;case"bottom":u.children=[c.t,c.l,c.r],l.children=[u,s];break;case"updiagonalstrike":u.children=[c.t,c.b,c.l,c.r,{type:"tag",name:"m:strikeBLTR",attribs:{"m:val":"on"},children:[]}],l.children=[u,s];break;case"downdiagonalstrike":u.children=[c.t,c.b,c.l,c.r,{type:"tag",name:"m:strikeTLBR",attribs:{"m:val":"on"},children:[]}],l.children=[u,s];break;case"verticalstrike":u.children=[c.t,c.b,c.l,c.r,{type:"tag",name:"m:strikeV",attribs:{"m:val":"on"},children:[]}],l.children=[u,s];break;case"horizontalstrike":u.children=[c.t,c.b,c.l,c.r,{type:"tag",name:"m:strikeH",attribs:{"m:val":"on"},children:[]}],l.children=[u,s];break;default:u.children=[c.t,c.b,c.l,c.r],l.children=[u,s]}t.children.push(l)}return s}function Ut(e,t,n,r,a){var i;if(2!==e.children.length)return t;var o=e.children[0],s=e.children[1],c={name:"m:num",type:"tag",attribs:{},children:[]},u={name:"m:den",type:"tag",attribs:{},children:[]};(a=(0,xt.Z)(a)).unshift(e),fn(o,c,!1,!1,a),fn(s,u,!1,!1,a);var l="0"===(null===(i=e.attribs)||void 0===i?void 0:i.linethickness)?"noBar":"bar";t.children.push({type:"tag",name:"m:f",attribs:{},children:[{type:"tag",name:"m:fPr",attribs:{},children:[{type:"tag",name:"m:type",attribs:{"m:val":l},children:[]}]},c,u]})}function Nt(e,t,n,r,a){e.attribs&&e.attribs.alt&&t.children.push({type:"text",data:e.attribs.alt})}function Rt(e,t,n,r,a){if(0!==e.children.length){var i=e.children[0],o=[],s=[],c=[],u=[],l=e.children.slice(1),p=!1;l.forEach((function(e,t){"mprescripts"===e.name?p=!0:"none"!==e.name&&(t%2?p?c.push(e):s.push(e):p?u.push(e):o.push(e))})),(a=(0,xt.Z)(a)).unshift(e);var d={children:[]};fn(i,d,!1,!1,a);var f=d.children[0];if(o.length||s.length){var m={name:"m:sub",type:"tag",attribs:{},children:[]};o.forEach((function(e){return fn(e,m,!1,!1,a)}));var h={name:"m:sup",type:"tag",attribs:{},children:[]};s.forEach((function(e){return fn(e,h,!1,!1,a)}));var g={type:"tag",attribs:{},children:[{type:"tag",name:"m:e",attribs:{},children:[f]}]};o.length&&s.length?(g.name="m:sSubSup",g.children.push(m),g.children.push(h)):o.length?(g.name="m:sSub",g.children.push(m)):(g.name="m:sSup",g.children.push(h)),f=g}if(c.length||u.length){var v={name:"m:sub",type:"tag",attribs:{},children:[]};c.forEach((function(e){return fn(e,v,!1,!1,a)}));var y={name:"m:sup",type:"tag",attribs:{},children:[]};u.forEach((function(e){return fn(e,y,!1,!1,a)})),f={name:"m:sPre",type:"tag",attribs:{},children:[{name:"m:e",type:"tag",attribs:{},children:[f]},v,y]}}t.children.push(f)}}function Mt(e,t,n,r,a){if(n.isNary){var i=t.children[t.children.length-1];return i.children[i.children.length-1]}return t}function Dt(e,t,n,r,a){t.children.push({name:"m:r",type:"tag",attribs:{},children:[{name:"m:t",type:"tag",attribs:{"xml:space":"preserve"},children:[{type:"text",data:" "}]}]})}function Lt(e,t,n,r,a){var i={name:"m:e",type:"tag",attribs:{},children:[]};return t.children.push({name:"m:rad",type:"tag",attribs:{},children:[{name:"m:radPr",type:"tag",attribs:{},children:[{name:"m:degHide",type:"tag",attribs:{"m:val":"on"},children:[]}]},{name:"m:deg",type:"tag",attribs:{},children:[]},i]}),i}function qt(e,t,n,r,a){return t}function Ft(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n="";if("text"===e.type){var r=e.data.replace(/[\u2062]|[\u200B]/g,"");t&&(r=r.trim()),n+=r}else e.children&&e.children.forEach((function(e){n+=Ft(e,t)}));return n}var Bt=/^[\u220f-\u2211]|[\u2229-\u2233]|[\u22c0-\u22c3]$/,$t=/^\u220f|\u2211|[\u2229-\u222b]|\u222e|\u222f|\u2232|\u2233|[\u22c0-\u22c3]$/;function zt(e){var t=Ft(e);return!!Bt.test(t)&&t}function Wt(e,t,n){var r,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=null===(r=t.attribs)||void 0===r?void 0:r.stretchy;return{type:"tag",name:"m:nary",attribs:{},children:[{type:"tag",name:"m:naryPr",attribs:{},children:[{type:"tag",name:"m:chr",attribs:{"m:val":e},children:[]},{type:"tag",name:"m:limLoc",attribs:{"m:val":n},children:[]},{type:"tag",name:"m:grow",attribs:{"m:val":"true"===o?"1":"false"===o?"0":$t.test(e)?"1":"0"},children:[]},{type:"tag",name:"m:subHide",attribs:{"m:val":a?"on":"off"},children:[]},{type:"tag",name:"m:supHide",attribs:{"m:val":i?"on":"off"},children:[]}]}]}}function Jt(e,t,n,r,a){var i,o;if(2!==e.children.length)return t;(a=(0,xt.Z)(a)).unshift(e);var s,c=e.children[0],u=e.children[1],l=zt(c);if(l&&"true"!==(null===(i=e.attribs)||void 0===i||null===(i=i.accent)||void 0===i?void 0:i.toLowerCase())&&"true"!==(null===(o=e.attribs)||void 0===o||null===(o=o.accentunder)||void 0===o?void 0:o.toLowerCase()))s=Wt(l,e,"subSup",!1,!0),e.isNary=!0;else{var p={name:"m:e",type:"tag",attribs:{},children:[]};fn(c,p,!1,!1,a),s={type:"tag",name:"m:sSub",attribs:{},children:[{type:"tag",name:"m:sSubPr",attribs:{},children:[{type:"tag",name:"m:ctrlPr",attribs:{},children:[]}]},p]}}var d={name:"m:sub",type:"tag",attribs:{},children:[]};fn(u,d,!1,!1,a),s.children.push(d),e.isNary&&(s.children.push({type:"tag",name:"m:sup",attribs:{},children:[]}),s.children.push({type:"tag",name:"m:e",attribs:{},children:[]})),t.children.push(s)}function Kt(e,t,n,r,a){var i,o;if(3!==e.children.length)return t;(a=(0,xt.Z)(a)).unshift(e);var s,c=e.children[0],u=e.children[1],l=e.children[2],p=zt(c);if(p&&"true"!==(null===(i=e.attribs)||void 0===i||null===(i=i.accent)||void 0===i?void 0:i.toLowerCase())&&"true"!==(null===(o=e.attribs)||void 0===o||null===(o=o.accentunder)||void 0===o?void 0:o.toLowerCase()))s=Wt(p,e,"subSup"),e.isNary=!0;else{var d={name:"m:e",type:"tag",attribs:{},children:[]};fn(c,d,!1,!1,a),s={type:"tag",name:"m:sSubSup",attribs:{},children:[{type:"tag",name:"m:sSubSupPr",attribs:{},children:[{type:"tag",name:"m:ctrlPr",attribs:{},children:[]}]},d]}}var f={name:"m:sub",type:"tag",attribs:{},children:[]},m={name:"m:sup",type:"tag",attribs:{},children:[]};fn(u,f,!1,!1,a),fn(l,m,!1,!1,a),s.children.push(f),s.children.push(m),e.isNary&&s.children.push({type:"tag",name:"m:e",attribs:{},children:[]}),t.children.push(s)}function Ht(e,t,n,r,a){var i,o;if(2!==e.children.length)return t;(a=(0,xt.Z)(a)).unshift(e);var s,c=e.children[0],u=e.children[1],l=zt(c);if(l&&"true"!==(null===(i=e.attribs)||void 0===i||null===(i=i.accent)||void 0===i?void 0:i.toLowerCase())&&"true"!==(null===(o=e.attribs)||void 0===o||null===(o=o.accentunder)||void 0===o?void 0:o.toLowerCase()))s=Wt(l,e,"subSup",!0),e.isNary=!0,s.children.push({type:"tag",name:"m:sub"});else{var p={name:"m:e",type:"tag",attribs:{},children:[]};fn(c,p,!1,!1,a),s={type:"tag",name:"m:sSup",attribs:{},children:[{type:"tag",name:"m:sSupPr",attribs:{},children:[{type:"tag",name:"m:ctrlPr",attribs:{},children:[]}]},p]}}var d={name:"m:sup",type:"tag",attribs:{},children:[]};fn(u,d,!1,!1,a),s.children.push(d),e.isNary&&s.children.push({type:"tag",name:"m:e",attribs:{},children:[]}),t.children.push(s)}function Xt(e,t,n,r,a){var i={name:"m:m",type:"tag",attribs:{},children:[{name:"m:mPr",type:"tag",attribs:{},children:[{name:"m:baseJc",type:"tag",attribs:{"m:val":"center"},children:[]},{name:"m:plcHide",type:"tag",attribs:{"m:val":"on"},children:[]},{name:"m:mcs",type:"tag",attribs:{},children:[{name:"m:mc",type:"tag",attribs:{},children:[{name:"m:mcPr",type:"tag",attribs:{},children:[{name:"m:count",type:"tag",attribs:{"m:val":Math.max.apply(Math,(0,xt.Z)(e.children.map((function(e){return e.children.length})))).toString()},children:[]},{name:"m:mcJc",type:"tag",attribs:{"m:val":"center"},children:[]}]}]}]}]}]};return t.children.push(i),i}function Yt(e,t,n,r,a){var i={name:"m:e",type:"tag",attribs:{},children:[]};return t.children.push(i),i}function Gt(e,t,n,r,a){var i={name:"m:mr",type:"tag",attribs:{},children:[]};return t.children.push(i),i}function Vt(e,t,n,r,a){var i,o;if(3!==e.children.length)return t;(a=(0,xt.Z)(a)).unshift(e);var s=e.children[0],c=e.children[1],u=e.children[2],l=zt(s);if(l&&"true"!==(null===(i=e.attributes)||void 0===i||null===(i=i.accent)||void 0===i?void 0:i.toLowerCase())&&"true"!==(null===(o=e.attributes)||void 0===o||null===(o=o.accentunder)||void 0===o?void 0:o.toLowerCase())){var p=Wt(l,e,"undOvr");e.isNary=!0;var d={name:"m:sub",type:"tag",attribs:{},children:[]},f={name:"m:sup",type:"tag",attribs:{},children:[]};return fn(c,d,!1,!1,a),fn(u,f,!1,!1,a),p.children.push(d),p.children.push(f),p.children.push({type:"tag",name:"m:e",attribs:{},children:[]}),void t.children.push(p)}var m={name:"m:e",type:"tag",attribs:{},children:[]};fn(s,m,!1,!1,a);var h={name:"m:lim",type:"tag",attribs:{},children:[]},g={name:"m:lim",type:"tag",attribs:{},children:[]};fn(c,h,!1,!1,a),fn(u,g,!1,!1,a),t.children.push({type:"tag",name:"m:limUpp",attribs:{},children:[{type:"tag",name:"m:e",attribs:{},children:[{type:"tag",name:"m:limLow",attribs:{},children:[m,h]}]},g]})}var Qt={bold:"b",italic:"i","bold-italic":"bi"};function en(e,t,n,r,a,i){if(n.isNary){var o=t.children[t.children.length-1];t=o.children[o.children.length-1]}var s=e.children&&e.children.find((function(e){return"mglyph"===e.name})),c=function(e,t){var n,r,a,i,o,s,c,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},l=e.attribs||{},p=l.mathcolor||(null===(n=t.find((function(e){return"mstyle"===e.name&&e.attribs&&e.attribs.color})))||void 0===n?void 0:n.attribs.color)||"",d=l.mathsize||(null===(r=t.find((function(e){return"mstyle"===e.name&&e.attribs&&e.attribs.mathsize})))||void 0===r?void 0:r.attribs.mathsize)||"",f=l.scriptlevel||(null===(a=t.find((function(e){return"mstyle"===e.name&&e.attribs&&e.attribs.scriptlevel})))||void 0===a?void 0:a.attribs.scriptlevel)||"",m=l.mathbackground||(null===(i=t.find((function(e){return"mstyle"===e.name&&e.attribs&&e.attribs.mathbackground})))||void 0===i?void 0:i.attribs.mathbackground)||"",h=l.mathvariant||(null===(o=t.find((function(e){return"mstyle"===e.name&&e.attribs&&e.attribs.mathvariant})))||void 0===o?void 0:o.attribs.mathvariant)||"";"b-i"===h&&(h="bold-italic");var g=l.fontweight||(null===(s=t.find((function(e){return"mstyle"===e.name&&e.attribs&&e.attribs.fontweight})))||void 0===s?void 0:s.attribs.fontweight)||"";"bold"!==g||["bold","bold-italic"].includes(h)?"normal"===g&&["bold","bold-italic"].includes(h)&&(h=h.includes("italic")?"italic":""):h=h.includes("italic")?"bold-italic":"bold";var v=l.fontstyle||(null===(c=t.find((function(e){return"mstyle"===e.name&&e.attribs&&e.attribs.fontstyle})))||void 0===c?void 0:c.attribs.fontstyle)||"";if("italic"!==v||["italic","bold-italic"].includes(h)?"normal"===v&&["italic","bold-italic"].includes(h)&&(h=h.includes("bold")?"bold":""):h=h.includes("bold")?"bold-italic":"italic",!l.mathvariant){var y=Ft(e);""===u.variant&&("mi"===e.name&&y.length>1||"mn"===e.name&&!/^\d+\.\d+$/.test(y))?h="":["mi","mn","mo"].includes(e.name)&&["italic","bold-italic"].includes(u.variant)&&(h="bold"===g?"bold-italic":"italic")}return{color:p,variant:h,size:d,scriptlevel:f,background:m,fontstyle:v}}(e,a,null==n?void 0:n.style);e.style=c,e.hasMglyphChild=s;var u,l=Object.keys(c).every((function(e){var t=null==n?void 0:n.style;return t&&c[e]===t[e]}))&&(null==n?void 0:n.hasMglyphChild)===s;if((i===(null==n?void 0:n.name)||["mi","mn","mo"].includes(i)&&["mi","mn","mo"].includes(null==n?void 0:n.name))&&l&&!s){var p=t.children[t.children.length-1];u=p.children[p.children.length-1]}else{var d={name:"m:r",type:"tag",attribs:{},children:[]};if(c.variant){var f={name:"w:rPr",type:"tag",attribs:{},children:[]};c.variant.includes("bold")&&f.children.push({name:"w:b",type:"tag",attribs:{},children:[]}),c.variant.includes("italic")&&f.children.push({name:"w:i",type:"tag",attribs:{},children:[]}),d.children.push(f);var m={name:"m:rPr",type:"tag",attribs:{},children:[{name:"m:nor",type:"tag",attribs:{},children:[]}]};"italic"!==c.variant&&m.children.push({name:"m:sty",type:"tag",attribs:{"m:val":Qt[c.variant]},children:[]}),d.children.push(m)}else s||"mtext"===i?d.children.push({name:"m:rPr",type:"tag",attribs:{},children:[{name:"m:nor",type:"tag",attribs:{},children:[]}]}):("normal"===c.fontstyle||"ms"===i&&""===c.fontstyle)&&d.children.push({name:"m:rPr",type:"tag",attribs:{},children:[{name:"m:sty",type:"tag",attribs:{"m:val":"p"},children:[]}]});u={name:"m:t",type:"tag",attribs:{"xml:space":"preserve"},children:[]},d.children.push(u),t.children.push(d)}return u}function tn(e,t,n,r,a){return en(e,t,n,0,a,"mtext")}function nn(e,t,n,r,a){return en(e,t,n,0,a,"mi")}function rn(e,t,n,r,a){return en(e,t,n,0,a,"mn")}function an(e,t,n,r,a){return en(e,t,n,0,a,"mo")}function on(e,t,n,r,a){return en(e,t,n,0,a,"ms")}var sn={"":"","":"","":"","":"","":"","":"","":"","":"","":"","^":"","":"","":"","`":"","-":"","":"","":"",".":"","~":"","":""};function cn(e,t,n,r,a,i){var o,s,c,u,l,p;if(2!==e.children.length)return t;(a=(0,xt.Z)(a)).unshift(e);var d=e.children[0],f=e.children[1],m=zt(d);if(m&&"true"!==(null===(o=e.attribs)||void 0===o||null===(o=o.accent)||void 0===o?void 0:o.toLowerCase())&&"true"!==(null===(s=e.attribs)||void 0===s||null===(s=s.accentunder)||void 0===s?void 0:s.toLowerCase())){var h=Wt(m,e,"undOvr","over"===i,"under"===i);e.isNary=!0;var g={name:"m:sub",type:"tag",attribs:{},children:[]},v={name:"m:sup",type:"tag",attribs:{},children:[]};return fn(f,"under"===i?g:v,!1,!1,a),h.children.push(g),h.children.push(v),h.children.push({type:"tag",name:"m:e",attribs:{},children:[]}),void t.children.push(h)}var y=Ft(f),b={name:"m:e",type:"tag",attribs:{},children:[]};if(fn(d,b,!1,!1,a),"under"===i&&"mo"===f.name&&["","_"].includes(y)||"over"===i&&"mo"===f.name&&["",""].includes(y))t.children.push({type:"tag",name:"m:bar",attribs:{},children:[{type:"tag",name:"m:barPr",attribs:{},children:[{type:"tag",name:"m:pos",attribs:{"m:val":"under"===i?"bot":"top"},children:[]}]},{type:"tag",name:"m:e",attribs:{},children:[{type:"tag",name:"under"===i?"m:sSub":"m:sSup",attribs:{},children:[{type:"tag",name:"under"===i?"m:sSubPr":"m:sSupPr",attribs:{},children:[{type:"tag",name:"m:ctrlPr",attribs:{},children:[]}]},b,{type:"tag",name:"m:sub",attribs:{},children:[]}]}]}]});else if("under"===i&&"true"===(null===(c=e.attribs)||void 0===c||null===(c=c.accentunder)||void 0===c?void 0:c.toLowerCase())&&"mo"===f.name&&y.length<2||"over"===i&&"true"===(null===(u=e.attribs)||void 0===u||null===(u=u.accent)||void 0===u?void 0:u.toLowerCase())&&"mo"===f.name&&y.length<2)t.children.push({type:"tag",name:"m:acc",attribs:{},children:[{type:"tag",name:"m:accPr",attribs:{},children:[{type:"tag",name:"m:chr",attribs:{"m:val":sn[y]||y},children:[]}]},b]});else if("true"===(null===(l=e.attribs)||void 0===l||null===(l=l.accent)||void 0===l?void 0:l.toLowerCase())||"true"===(null===(p=e.attribs)||void 0===p||null===(p=p.accentunder)||void 0===p?void 0:p.toLowerCase())||"mo"!==f.name||"mrow"!==d.name||1!==y.length){var w={name:"m:lim",type:"tag",attribs:{},children:[]};fn(f,w,!1,!1,a),t.children.push({type:"tag",name:"under"===i?"m:limLow":"m:limUpp",attribs:{},children:[b,w]})}else t.children.push({type:"tag",name:"m:groupChr",attribs:{},children:[{type:"tag",name:"m:groupChrPr",attribs:{},children:[{type:"tag",name:"m:chr",attribs:{"m:val":y,"m:pos":"under"===i?"bot":"top"},children:[]}]},b]})}function un(e,t,n,r,a){return cn(e,t,0,0,a,"under")}function ln(e,t,n,r,a){return cn(e,t,0,0,a,"over")}function pn(e,t,n,r,a){if(2!==e.children.length)return t;(a=(0,xt.Z)(a)).unshift(e);var i=e.children[0],o=e.children[1],s={type:"tag",name:"m:e",attribs:{},children:[]};fn(i,s,!1,!1,a);var c={type:"tag",name:"m:deg",attribs:{},children:[]};fn(o,c,!1,!1,a);var u=Ft(o);t.children.push({type:"tag",name:"m:rad",attribs:{},children:[{type:"tag",name:"m:radPr",attribs:{},children:[{type:"tag",name:"m:degHide",attribs:{"m:val":u.length?"off":"on"},children:[]}]},c,s]})}function dn(e,t,n,r,a){var i=e.data.replace(/[\u2062]|[\u200B]/g,"");if(a.find((function(e){return["mi","mn","mo"].includes(e.name)})))i=i.replace(/\s/g,"").replace(/</g,"&lt;").replace(/>/g,"&gt;");else{var o,s,c=a.find((function(e){return"ms"===e.name}));c&&(i=((null===(o=c.attribs)||void 0===o?void 0:o.lquote)||'"')+i+((null===(s=c.attribs)||void 0===s?void 0:s.rquote)||'"'))}return i.length&&(t.children.length&&"text"===t.children[t.children.length-1].type?t.children[t.children.length-1].data+=i:t.children.push({type:"text",data:i})),t}function fn(e,t){var n,a,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];!i&&["m:deg","m:den","m:e","m:fName","m:lim","m:num","m:sub","m:sup"].includes(t.name)&&function(e,t){var n,r=null===(n=t.find((function(e){var t;return null===(t=e.attribs)||void 0===t?void 0:t.scriptlevel})))||void 0===n||null===(n=n.attribs)||void 0===n?void 0:n.scriptlevel;["0","1","2"].includes(r)&&e.children.unshift({type:"tag",name:"m:argPr",attribs:{},children:[{type:"tag",name:"m:scrLvl",attribs:{"m:val":r},children:[]}]})}(t,s);var c=e.name||e.type;if(r[c]?a=r[c](e,t,i,o,s):(c&&"root"!==c&&console.warn("Type not supported: ".concat(c)),a=t),a&&null!==(n=e.children)&&void 0!==n&&n.length){(s=(0,xt.Z)(s)).unshift(e);for(var u=0;u<e.children.length;u++)fn(e.children[u],a,e.children[u-1],e.children[u+1],s)}}var mn=function(){function e(t){(0,h.Z)(this,e),this.inString=t,this.inXML=function(e,t){t||(t={}),t.components||(t.components=At);var n,r=[],a=[],i=-1;return e.replace(Tt,(function(o,s){var c,u="/"!==o.charAt(1),l=o.startsWith("\x3c!--"),p=s+o.length,d=e.charAt(p);if(l){var f=Pt(o);return i<0?(r.push(f),r):((c=a[i]).children.push(f),r)}if(u&&(i++,"tag"===(n=Pt(o)).type&&t.components[n.name]&&(n.type="component"),Et.includes(n.name)&&!n.voidElement&&d&&"<"!==d&&n.children.push({type:"text",data:kt.yo(e.slice(p,e.indexOf("<",p))).trim()}),0===i&&r.push(n),(c=a[i-1])&&c.children.push(n),a[i]=n),(!u||n.voidElement)&&(i>-1&&(n.voidElement||n.name===o.slice(2,-1))&&(i--,n=-1===i?r:a[i]),i>-1&&Et.includes[a[i].name]&&"<"!==d&&d)){c=a[i].children;var m=e.indexOf("<",p),h=e.slice(p,-1===m?void 0:m);St.test(h)&&(h=" "),(m>-1&&i+c.length>=0||" "!==h)&&c.push({type:"text",data:kt.yo(h)})}})),r}(t),this.outXML=!1,this.outString=!1}return(0,m.Z)(e,[{key:"run",value:function(){var e={};fn({children:this.inXML,type:"root"},e),this.outXML=e}},{key:"getResult",value:function(){return this.outString=[this.outXML].reduce((function(e,t){return e+jt("",t)}),""),this.outString}}]),e}(),hn=function(e){var t=new mn(e);return t.run(),t.getResult()};function gn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function vn(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{return _t.Z.renderToString(e,{throwOnError:!0,output:"mathml",displayMode:t,strict:!1}).replace(/^<span class="katex">/,"").replace(/<\/span>$/,"")}catch(t){return console.error("LaTeX conversion error:",t),"[Error converting equation: ".concat(e,"]")}}function yn(e){return e=e.replace(/<\?xml[^>]*\?>/,"").replace(/<!DOCTYPE[^>]*>/,""),hn(e)}function bn(e){var t=[];return{text:e=(e=e.replace(/\$\$([\s\S]*?)\$\$/g,(function(e,n){var r=yn(vn(n.trim(),!0));return t.push({type:"block",ooxml:r,placeholder:'  <p math="true">EQUATION_'.concat(t.length,"</p>")}),'  <p math="true">EQUATION_'.concat(t.length-1,"</p>")}))).replace(/\$([^$\n]*?)\$/g,(function(e,n){if(/\$\d+(?:\.\d+)?(?:\|\$\d+(?:\.\d+)?)+/.test(e))return e;if(/^\$\s*\d+(,\d{3})*(\.\d+)?\s*$/.test(e))return e;if(!(/[a-zA-Z\\--\+\-\*\/\^_=<>\{\}]/.test(n)||/\d+[a-zA-Z]/.test(n)||/[a-zA-Z]\d+/.test(n)))return e;var r=yn(vn(n.trim(),!1));return t.push({type:"inline",ooxml:r,placeholder:'<span math="true">EQUATION_'.concat(t.length,"</span>")}),'<span math="true">EQUATION_'.concat(t.length-1,"</span>")})),equations:t}}function wn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,n=document.createElement("div");n.innerHTML=e;var r=[];function a(e,t,n,r){var o="",s=Array.from(e.childNodes).filter((function(e){return e.nodeType===Node.TEXT_NODE||e.nodeType===Node.ELEMENT_NODE&&!["ul","ol"].includes(e.nodeName.toLowerCase())})).map((function(e){if(e.nodeType===Node.TEXT_NODE){var t=_n(e.textContent);return(e.textContent||"").trim()?"<w:r><w:t>".concat((t||"").trim(),"</w:t></w:r>"):""}return i(e,!0)})).join("");o+='\n            <w:p>\n                <w:pPr>\n                    <w:pStyle w:val="'.concat(t?"ListNumber":"ListBullet",'"/>\n                    <w:numPr>\n                        <w:ilvl w:val="').concat(n,'"/>\n                        <w:numId w:val="').concat(r,'"/>\n                    </w:numPr>\n                     <w:ind w:left="').concat(360*(n+1),'" w:hanging="360"/>\n                </w:pPr>\n                ').concat(s,"\n            </w:p>\n           \n        ");var c,u=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return gn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?gn(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}(Array.from(e.children).filter((function(e){return["ul","ol"].includes(e.tagName.toLowerCase())})));try{for(u.s();!(c=u.n()).done;)for(var l=c.value,p="ol"===l.tagName.toLowerCase(),d=Array.from(l.children),f=0,m=d;f<m.length;f++)o+=a(m[f],p,n+1,r)}catch(e){u.e(e)}finally{u.f()}return o}function i(e,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;switch(e.nodeType){case Node.ELEMENT_NODE:switch(e.tagName.toLowerCase()){case"p":if(e.getAttribute("math")){var s=parseInt((e.textContent||"").replace("EQUATION_",""));if(t[s])return n?"<w:br/><w:r>".concat(t[s].ooxml,"</w:r><w:br/>"):"\n                                <w:p>\n                                    <w:r>".concat(t[s].ooxml,"</w:r>\n                                </w:p>\n                                <w:p>\n                                </w:p>\n                                ")}return n?Array.from(e.childNodes).map((function(e){return i(e,n)})).join(""):"\n                            <w:p>\n                                ".concat(Array.from(e.childNodes).map((function(e){return i(e,!0)})).join(""),"\n                            </w:p>\n                            <w:p>\n                            </w:p>\n                            ");case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":return function(e){var t=parseInt(e.tagName[1]),n=20-2*(t-1),r=t<=2?"2F5496":"1F3763",a=240+60*(6-t),i=_n(e.textContent);return'\n        <w:p> </w:p>\n        <w:p>\n            <w:pPr>\n                <w:pStyle w:val="Heading'.concat(t,'"/>\n                <w:spacing w:before="').concat(a,'" w:after="').concat(a,'"/>\n                <w:rPr>\n                    <w:rFonts w:ascii="Calibri" w:hAnsi="Calibri"/>\n                    <w:sz w:val="').concat(2*n,'"/>\n                    <w:szCs w:val="').concat(2*n,'"/>\n                    <w:color w:val="').concat(r,'"/>\n                </w:rPr>\n            </w:pPr>\n            <w:r>\n                <w:rPr>\n                    <w:rFonts w:ascii="Calibri" w:hAnsi="Calibri"/>\n                    <w:sz w:val="').concat(2*n,'"/>\n                    <w:szCs w:val="').concat(2*n,'"/>\n                    <w:color w:val="').concat(r,'"/>\n                </w:rPr>\n                <w:t>').concat(i,"</w:t>\n            </w:r>\n        </w:p>\n        <w:p> </w:p>\n    ")}(e);case"strong":case"b":return"<w:r><w:rPr><w:b/></w:rPr>".concat(Array.from(e.childNodes).map((function(e){return i(e,!1)})).join(""),"</w:r>");case"em":case"i":return"<w:r><w:rPr><w:i/></w:rPr>".concat(Array.from(e.childNodes).map((function(e){return i(e,!1)})).join(""),"</w:r>");case"ul":case"ol":var c=Math.floor(Date.now()+1e3*Math.random()),u="ol"===e.tagName.toLowerCase();return Array.from(e.children).map((function(e){return a(e,u,o,c)})).join("")+" <w:p> </w:p>";case"span":if(e.getAttribute("math")){var l=parseInt(e.textContent.replace("EQUATION_",""));if(t[l])return"<w:r>".concat(t[l].ooxml,"</w:r>")}var p=_n(e.textContent);return"<w:r><w:t>".concat(p,"</w:t></w:r>");case"br":return"<w:br/>";case"code":var d=_n(e.textContent);return n?'<w:r>\n                                <w:rPr>\n                                    <w:shd w:val="clear" w:color="auto" w:fill="D3D3D3"/>\n                                </w:rPr>\n                                <w:t xml:space="preserve"> '.concat(d," </w:t>\n                            </w:r>"):'<w:p><w:r><w:rPr><w:rStyle w:val="Code"/></w:rPr><w:t>'.concat(d,"</w:t></w:r></w:p>");case"table":return function(e){var n=Array.from(e.getElementsByTagName("tr")),r=Math.max.apply(Math,(0,xt.Z)(n.map((function(e){return Array.from(e.children).length})))),a=Math.floor(9e3/r);return'\n        <w:p/>\n        <w:tbl>\n            <w:tblPr>\n                <w:tblStyle w:val="TableGrid"/>\n                <w:tblW w:w="5000" w:type="pct"/>\n                <w:tblBorders>\n                    <w:top w:val="single" w:sz="4" w:space="0" w:color="BFBFBF"/>\n                    <w:left w:val="single" w:sz="4" w:space="0" w:color="BFBFBF"/>\n                    <w:bottom w:val="single" w:sz="4" w:space="0" w:color="BFBFBF"/>\n                    <w:right w:val="single" w:sz="4" w:space="0" w:color="BFBFBF"/>\n                    <w:insideH w:val="single" w:sz="4" w:space="0" w:color="BFBFBF"/>\n                    <w:insideV w:val="single" w:sz="4" w:space="0" w:color="BFBFBF"/>\n                </w:tblBorders>\n                <w:tblLook w:val="04A0" w:firstRow="1" w:lastRow="0" w:firstColumn="1" w:lastColumn="0" w:noHBand="0" w:noVBand="1"/>\n                <w:shd w:val="clear" w:color="auto" w:fill="D9EAD3"/>\n            </w:tblPr>\n            <w:tblGrid>\n                '.concat(Array(r).fill('<w:gridCol w:w="'.concat(a,'"/>')).join(""),"\n            </w:tblGrid>\n            ").concat(n.map((function(e,n){return function(e,n){var r=Array.from(e.children);return"\n        <w:tr>\n            ".concat(r.map((function(e){return function(e,n){var r=n?'<w:tcPr>\n               <w:shd w:val="clear" w:fill="EEEEEE"/>\n               <w:vAlign w:val="center"/>\n               <w:tcMar>\n                   <w:top w:w="100" w:type="dxa"/>\n                   <w:left w:w="100" w:type="dxa"/>\n                   <w:bottom w:w="100" w:type="dxa"/>\n                   <w:right w:w="100" w:type="dxa"/>\n               </w:tcMar>\n               <w:tcW w:w="1000" w:type="dxa"/>\n           </w:tcPr>':'<w:tcPr>\n               <w:shd w:val="clear" w:fill="FFFFFF"/>\n               <w:tcMar>\n                   <w:top w:w="100" w:type="dxa"/>\n                   <w:left w:w="100" w:type="dxa"/>\n                   <w:bottom w:w="100" w:type="dxa"/>\n                   <w:right w:w="100" w:type="dxa"/>\n               </w:tcMar>\n               <w:tcW w:w="1000" w:type="dxa"/>\n           </w:tcPr>',a=Array.from(e.childNodes).map((function(e){if(e.nodeType===Node.TEXT_NODE){var n=e.textContent||"";return n.trim()?"<w:r><w:t>".concat(_n(n),"</w:t></w:r>"):""}if(e.nodeType===Node.ELEMENT_NODE){var r=e;if("span"===r.tagName.toLowerCase()&&r.getAttribute("math")){var a,o=parseInt((null===(a=r.textContent)||void 0===a?void 0:a.replace("EQUATION_",""))||"0");if(t[o])return"<w:r>".concat(t[o].ooxml,"</w:r>")}return i(r,!0)}return""})).join("");return"\n        <w:tc>\n            ".concat(r,'\n            <w:p>\n                <w:pPr>\n                    <w:spacing w:before="0" w:after="0" w:line="240" w:lineRule="auto"/>\n                    ').concat(n?'<w:jc w:val="center"/>':"","\n                </w:pPr>\n                ").concat(a,"\n            </w:p>\n        </w:tc>\n        ")}(e,n)})).join(""),"\n        </w:tr>\n        ")}(e,0===n)})).join(""),"\n        </w:tbl>\n        ")}(e);case"th":case"td":return e.textContent||"";case"a":var f=e.getAttribute("href"),m=_n(e.textContent);if(f){var h="rId".concat(Math.floor(Date.now()*Math.random()));return r.push({id:h,url:f}),'\n                                    <w:hyperlink r:id="'.concat(h,'" w:history="1">\n                                        <w:r>\n                                            <w:rPr>\n                                                <w:rStyle w:val="Hyperlink"/>\n                                                <w:color w:val="0000FF"/>\n                                                <w:u w:val="single"/>\n                                            </w:rPr>\n                                            <w:t xml:space="preserve"> ').concat(m," </w:t>\n                                        </w:r>\n                                    </w:hyperlink>\n                                ")}return'<w:r><w:t xml:space="preserve"> '.concat(m," </w:t></w:r>");default:return Array.from(e.childNodes).map((function(e){return i(e,!1)})).join("")}case Node.TEXT_NODE:if(e.textContent.trim()){var g=_n(e.textContent);return"<w:r><w:t>".concat(g,"</w:t></w:r>")}return"";default:return""}}return Array.from(n.childNodes).map((function(e){return{html:e.outerHTML,ooxml:i(e,!1)}})).filter((function(e){return!!e.ooxml})).map((function(e){var t=e.ooxml,n=e.html;return{ooxml:xn(t,r),html:n}}))}function xn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=e.trim();return n.startsWith("<w:r>")&&(n="<w:p>".concat(e,"</w:p>")),'\n        <pkg:package xmlns:pkg="http://schemas.microsoft.com/office/2006/xmlPackage">\n          <pkg:part pkg:name="/_rels/.rels" pkg:contentType="application/vnd.openxmlformats-package.relationships+xml" pkg:padding="512">\n            <pkg:xmlData>\n              <Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">\n                <Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="word/document.xml"/>\n              </Relationships>\n            </pkg:xmlData>\n          </pkg:part>\n          <pkg:part pkg:name="/word/document.xml" pkg:contentType="application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml">\n            <pkg:xmlData>\n             <w:document \n                xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main"\n                xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"\n             >\n                <w:body>\n                    '.concat(n,'\n                </w:body>\n            </w:document>\n            </pkg:xmlData>\n          </pkg:part>\n          <pkg:part pkg:name="/word/_rels/document.xml.rels" pkg:contentType="application/vnd.openxmlformats-package.relationships+xml">\n            <pkg:xmlData>\n                <Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">\n                ').concat(t.map((function(e){return'\n                    <Relationship \n                    Id="'.concat(e.id,'"\n                    Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink"\n                    Target="').concat(e.url,'"\n                    TargetMode="External"\n                    />')})).join(""),"\n                </Relationships>\n            </pkg:xmlData>\n          </pkg:part>\n        </pkg:package>")}function _n(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}function kn(e){return On.apply(this,arguments)}function On(){return(On=(0,a.Z)(o().mark((function e(t){var n,r,a,i,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=bn(t),r=n.text,a=n.equations,e.next=3,Le(r);case 3:return i=e.sent,s=wn(i,a),e.abrupt("return",s);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Pn(e){return Tn.apply(this,arguments)}function Tn(){return Tn=(0,a.Z)(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.replace(/\\\$[\n\r\s]*/g,"$$").replace(/<latex>[\n\r\s]*|[\n\r\s]*<\/latex>/g,"$$").replace(/\\\[[\n\r\s]*|[\n\r\s]*\\\]/g,"$$").replace(/\\\([\n\r\s]*|[\n\r\s]*\\\)/g,"$$"),e.next=4,Word.run(function(){var e=(0,a.Z)(o().mark((function e(t){var r,a,i,s,c,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.document.getSelection(),e.next=3,kn(n);case 3:a=e.sent,i=0;case 5:if(!(i<a.length)){e.next=13;break}return s=a[i],c=s.ooxml,(u=s.html)&&u.indexOf("<img")>0?r=(r=r.insertHtml(u,Word.InsertLocation.after)).insertText("\n",Word.InsertLocation.after):c?r=r.insertOoxml(c,Word.InsertLocation.after):u&&(r=r.insertHtml(u,Word.InsertLocation.after)),e.next=10,t.sync();case 10:i++,e.next=5;break;case 13:return r.insertText("",Word.InsertLocation.after).select(),e.next=17,t.sync();case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 4:e.next=10;break;case 6:throw e.prev=6,e.t0=e.catch(0),console.error("Error inserting markdown:",e.t0),e.t0;case 10:case"end":return e.stop()}}),e,null,[[0,6]])}))),Tn.apply(this,arguments)}function Sn(e,t){return En.apply(this,arguments)}function En(){return En=(0,a.Z)(o().mark((function e(t,n){var r,a,i,s,c,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.context,a=n.insertFootnote(""),r.trackedObjects.add(a),i=a.body.paragraphs.getFirst(),e.next=6,r.sync();case 6:return s=t.authors.map((function(e){return"".concat(e.lastName,", ").concat(e.initials)})).join(", "),i.insertText("".concat(s," (").concat(t.year,")"),"End").font.italic=!1,(c=i.insertText(" ".concat(t.title),"End")).font.italic=!1,c.hyperlink=t.url,t.journal&&(u=[t.journal.name,t.journal.volume].filter(Boolean).join(" "),i.insertText(" ".concat(u),"End").font.italic=!0,t.journal.pages&&(i.insertText(", ".concat(t.journal.pages),"End").font.italic=!1)),e.next=14,r.sync();case 14:case"end":return e.stop()}}),e)}))),En.apply(this,arguments)}function An(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return jn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?jn(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function jn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Cn(e,t){return In.apply(this,arguments)}function In(){return In=(0,a.Z)(o().mark((function e(t,n){var r,i=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>2&&void 0!==i[2]?i[2]:Word.InsertLocation.after,e.prev=1,e.next=4,Word.run(function(){var e=(0,a.Z)(o().mark((function e(n){var i,s,c,u,l,p;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(i=n.document.getSelection()).load(["isEmpty","text"]),e.next=4,n.sync();case 4:if(!i.isEmpty){e.next=6;break}return e.abrupt("return","");case 6:return s=i.text,c=i.insertText("Writing...\n",Word.InsertLocation.after),e.next=10,n.sync();case 10:return u=new Be,e.next=13,V();case 13:return l=e.sent,p=l.apiKey,e.next=17,wt(t,s,{model:p?void 0:"gpt-4o-mini",stream:!0,temperature:.8},function(){var e=(0,a.Z)(o().mark((function e(t,n){var r,a,i,s,c,l,p,d,f,m;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=23;break}return e.next=3,u.finalize();case 3:a=e.sent,i=An(a),e.prev=5,i.s();case 7:if((s=i.n()).done){e.next=14;break}if(!(c=s.value).trim()){e.next=12;break}return e.next=12,Pn(c);case 12:e.next=7;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(5),i.e(e.t0);case 19:return e.prev=19,i.f(),e.finish(19);case 22:return e.abrupt("return");case 23:if(null===(r=n.delta)||void 0===r||!r.content){e.next=47;break}return e.next=26,u.processStream(n.delta.content);case 26:l=e.sent,p=l.newParagraphs,l.remainingBuffer,d=An(p),e.prev=30,d.s();case 32:if((f=d.n()).done){e.next=39;break}if(!(m=f.value).trim()){e.next=37;break}return e.next=37,Pn(m);case 37:e.next=32;break;case 39:e.next=44;break;case 41:e.prev=41,e.t1=e.catch(30),d.e(e.t1);case 44:return e.prev=44,d.f(),e.finish(44);case 47:case"end":return e.stop()}}),e,null,[[5,16,19,22],[30,41,44,47]])})));return function(t,n){return e.apply(this,arguments)}}());case 17:c.delete(),r===Word.InsertLocation.replace&&i.delete();case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 4:e.next=12;break;case 6:return e.prev=6,e.t0=e.catch(1),e.next=10,Word.run(function(){var t=(0,a.Z)(o().mark((function t(n){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.document.getSelection().insertText("Sorry, there was an error.\n"+e.t0.toString(),Word.InsertLocation.after),t.next=4,n.sync();case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 10:console.error(e.t0),n.completed();case 12:return e.prev=12,n.completed(),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[1,6,12,15]])}))),In.apply(this,arguments)}function Zn(){return(Zn=(0,a.Z)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Cn("make_longer",t,"Replace");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Un(){return(Un=(0,a.Z)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Cn("make_shorter",t,"Replace");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Nn(){return(Nn=(0,a.Z)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Cn("summarize",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Rn(){return(Rn=(0,a.Z)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Cn("contine_write",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Mn(){return(Mn=(0,a.Z)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Cn("refine",t,"Replace");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Dn(){return Dn=(0,a.Z)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Word.run(function(){var e=(0,a.Z)(o().mark((function e(t){var n,r,a,i,s,c,u,l,p,d,f,m,h,v,y,b,w;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=t.document.getSelection()).load(["isEmpty","text"]),e.next=4,t.sync();case 4:if(!n.isEmpty){e.next=6;break}return e.abrupt("return","");case 6:return r=n.text,a=n.insertText("Checking...\n",Word.InsertLocation.after),e.next=10,t.sync();case 10:return e.next=12,V();case 12:return i=e.sent,s=i.apiKey,e.next=16,wt("spell_check",r,{model:s?void 0:"gpt-4o-mini",stream:!1,temperature:.8});case 16:if(!(c=e.sent)){e.next=38;break}u=(0,g.dC)(c),l=u.comments,p=void 0===l?[]:l,d=0;case 21:if(!(d<p.length)){e.next=38;break}return f=p[d],m=f.original,f.suggestion,h=f.corrected,f.type,(v=n.search(m)).load("items"),e.next=27,t.sync();case 27:if(v.items.length){e.next=29;break}return e.abrupt("continue",35);case 29:y=An(v.items);try{for(y.s();!(b=y.n()).done;)(w=b.value).insertText(h,Word.InsertLocation.replace),w.insertComment("".concat(m,"->").concat(h))}catch(e){y.e(e)}finally{y.f()}return e.next=33,t.sync();case 33:return e.next=35,(0,g._v)(500);case 35:d++,e.next=21;break;case 38:a.delete();case 39:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:e.next=11;break;case 5:return e.prev=5,e.t0=e.catch(0),e.next=9,Word.run(function(){var t=(0,a.Z)(o().mark((function t(n){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.document.getSelection().insertText("Sorry, there was an error.\n"+e.t0.toString(),Word.InsertLocation.after),t.next=4,n.sync();case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 9:console.error(e.t0),t.completed();case 11:return e.prev=11,t.completed(),e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[0,5,11,14]])}))),Dn.apply(this,arguments)}function Ln(){return Ln=(0,a.Z)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Word.run(function(){var e=(0,a.Z)(o().mark((function e(t){var n,r,a,i,s,c,u,l,p,d,f,m,h,v,y,b,w,x;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=t.document.getSelection()).load(["isEmpty","text"]),e.next=4,t.sync();case 4:if(!n.isEmpty){e.next=6;break}return e.abrupt("return","");case 6:return r=n.text,a=n.insertText("Checking...\n",Word.InsertLocation.after),e.next=10,t.sync();case 10:return e.next=12,V();case 12:return i=e.sent,s=i.apiKey,e.next=16,wt("spell_grammar",r,{model:s?void 0:"gpt-4o-mini",stream:!1,temperature:.8});case 16:if(!(c=e.sent)){e.next=38;break}u=(0,g.dC)(c),l=u.comments,p=void 0===l?[]:l,d=0;case 21:if(!(d<p.length)){e.next=38;break}return f=p[d],m=f.original,h=f.suggestion,v=f.corrected,f.type,(y=n.search(m)).load("items"),e.next=27,t.sync();case 27:if(y.items.length){e.next=29;break}return e.abrupt("continue",35);case 29:b=An(y.items);try{for(b.s();!(w=b.n()).done;)(x=w.value).insertText(v,Word.InsertLocation.replace),x.insertComment(h)}catch(e){b.e(e)}finally{b.f()}return e.next=33,t.sync();case 33:return e.next=35,(0,g._v)(500);case 35:d++,e.next=21;break;case 38:a.delete();case 39:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:e.next=11;break;case 5:return e.prev=5,e.t0=e.catch(0),e.next=9,Word.run(function(){var t=(0,a.Z)(o().mark((function t(n){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.document.getSelection().insertText("Sorry, there was an error.\n"+e.t0.toString(),Word.InsertLocation.after),t.next=4,n.sync();case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 9:console.error(e.t0),t.completed();case 11:return e.prev=11,t.completed(),e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[0,5,11,14]])}))),Ln.apply(this,arguments)}function qn(){return qn=(0,a.Z)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=1,e.next=4,Word.run(function(){var e=(0,a.Z)(o().mark((function e(t){var n,r,a,i,s,c,u,l,p,d,f;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=t.document.getSelection()).load(["isEmpty","text"]),e.next=4,t.sync();case 4:if(!n.isEmpty){e.next=6;break}return e.abrupt("return","");case 6:return r=n.text,a=n.insertText("Searching...\n",Word.InsertLocation.after),e.next=10,t.sync();case 10:return e.next=12,V();case 12:return i=e.sent,s=i.apiKey,e.next=16,wt("add_citation",r,{model:s?void 0:"gpt-4o-mini",stream:!1,temperature:.8});case 16:if(!(c=e.sent)){e.next=26;break}return u=(0,g.dC)(c),l=u.title,e.next=22,xe.searchScholar({keyword:l});case 22:return(p=e.sent).length>0&&(d=p[0],f=d.link||d.pdfUrl,u.url=f),e.next=26,Sn(u,n);case 26:return a.delete(),e.abrupt("return",t.sync());case 28:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 4:e.next=11;break;case 6:return e.prev=6,e.t0=e.catch(1),e.next=10,Word.run(function(){var t=(0,a.Z)(o().mark((function t(n){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.document.getSelection().insertText("Sorry, there was an error.\n"+e.t0.toString(),Word.InsertLocation.after),t.next=4,n.sync();case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 10:console.error(e.t0);case 11:return e.prev=11,t.completed(),e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[1,6,11,14]])}))),qn.apply(this,arguments)}function Fn(){return Fn=(0,a.Z)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Word.run(function(){var e=(0,a.Z)(o().mark((function e(t){var n,r,a,i,s,c,u,l,p,d,f,m,h,v,y,b;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=t.document.getSelection()).load(["isEmpty","text"]),e.next=4,t.sync();case 4:if(!n.isEmpty){e.next=6;break}return e.abrupt("return","");case 6:return r=n.text,a=n.insertText("Reviewing...\n",Word.InsertLocation.after),e.next=10,t.sync();case 10:return e.next=12,V();case 12:return i=e.sent,s=i.apiKey,e.next=16,wt("review_comment",r,{model:s?void 0:"gpt-4o-mini",stream:!1,temperature:.8});case 16:if(!(c=e.sent)){e.next=36;break}u=(0,g.dC)(c),l=u.comments,p=void 0===l?[]:l,d=0;case 21:if(!(d<p.length)){e.next=36;break}return f=p[d],m=f.original,h=f.suggestion,f.type,(v=n.search(m)).load("items"),e.next=27,t.sync();case 27:y=An(v.items);try{for(y.s();!(b=y.n()).done;)b.value.insertComment(h)}catch(e){y.e(e)}finally{y.f()}return e.next=31,t.sync();case 31:return e.next=33,(0,g._v)(1e3);case 33:d++,e.next=21;break;case 36:a.delete();case 37:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:e.next=10;break;case 5:return e.prev=5,e.t0=e.catch(0),e.next=9,Word.run(function(){var t=(0,a.Z)(o().mark((function t(n){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.document.getSelection().insertText("Sorry, there was an error.\n"+e.t0.toString(),Word.InsertLocation.after),t.next=4,n.sync();case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 9:console.error(e.t0);case 10:return e.prev=10,t.completed(),e.finish(10);case 13:case"end":return e.stop()}}),e,null,[[0,5,10,13]])}))),Fn.apply(this,arguments)}function Bn(){return Bn=(0,a.Z)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Word.run(function(){var e=(0,a.Z)(o().mark((function e(t){var n,r,a,i,s,c,u,l,p,d,f,m,h,v,y,b,w,x;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=t.document.getSelection()).load(["isEmpty","text"]),e.next=4,t.sync();case 4:if(!n.isEmpty){e.next=6;break}return e.abrupt("return","");case 6:return r=n.text,a=n.insertText("Correcting...\n",Word.InsertLocation.after),e.next=10,t.sync();case 10:return e.next=12,V();case 12:return i=e.sent,s=i.apiKey,e.next=16,wt("correct_comment",r,{model:s?void 0:"gpt-4o-mini",stream:!1,temperature:.8});case 16:if(!(c=e.sent)){e.next=36;break}u=(0,g.dC)(c),l=u.comments,p=void 0===l?[]:l,d=0;case 21:if(!(d<p.length)){e.next=36;break}return f=p[d],m=f.original,h=f.suggestion,v=f.corrected,f.type,(y=n.search(m)).load("items"),e.next=27,t.sync();case 27:b=An(y.items);try{for(b.s();!(w=b.n()).done;)(x=w.value).insertText(v,Word.InsertLocation.replace),x.insertComment(h)}catch(e){b.e(e)}finally{b.f()}return e.next=31,t.sync();case 31:return e.next=33,(0,g._v)(1e3);case 33:d++,e.next=21;break;case 36:a.delete();case 37:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:e.next=10;break;case 5:return e.prev=5,e.t0=e.catch(0),e.next=9,Word.run(function(){var t=(0,a.Z)(o().mark((function t(n){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.document.getSelection().insertText("Sorry, there was an error.\n"+e.t0.toString(),Word.InsertLocation.after),t.next=4,n.sync();case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 9:console.error(e.t0);case 10:return e.prev=10,t.completed(),e.finish(10);case 13:case"end":return e.stop()}}),e,null,[[0,5,10,13]])}))),Bn.apply(this,arguments)}function $n(){return $n=(0,a.Z)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Word.run(function(){var e=(0,a.Z)(o().mark((function e(t){var n,r,a,i,s,c,u,l,p,d,f,m,h,v,y,b;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=t.document.getSelection()).load(["isEmpty","text"]),e.next=4,t.sync();case 4:if(!n.isEmpty){e.next=6;break}return e.abrupt("return","");case 6:return r=n.text,a=n.insertText("Detecting...\n",Word.InsertLocation.after),e.next=10,t.sync();case 10:return e.next=12,V();case 12:return i=e.sent,s=i.apiKey,e.next=16,wt("detect",r,{model:s?void 0:"gpt-4o-mini",stream:!1,temperature:.8});case 16:if(!(c=e.sent)){e.next=38;break}u=(0,g.dC)(c),l=u.comments,p=void 0===l?[]:l,d=0;case 21:if(!(d<p.length)){e.next=38;break}return f=p[d],m=f.sentences,h=f.explanation,(v=n.search(m)).load("items"),e.next=27,t.sync();case 27:if(v.items.length){e.next=29;break}return e.abrupt("continue",35);case 29:y=An(v.items);try{for(y.s();!(b=y.n()).done;)b.value.insertComment(h)}catch(e){y.e(e)}finally{y.f()}return e.next=33,t.sync();case 33:return e.next=35,(0,g._v)(1e3);case 35:d++,e.next=21;break;case 38:a.delete();case 39:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:e.next=10;break;case 5:return e.prev=5,e.t0=e.catch(0),e.next=9,Word.run(function(){var t=(0,a.Z)(o().mark((function t(n){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.document.getSelection().insertText("Sorry, there was an error.\n"+e.t0.toString(),Word.InsertLocation.after),t.next=4,n.sync();case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 9:console.error(e.t0);case 10:return e.prev=10,t.completed(),e.finish(10);case 13:case"end":return e.stop()}}),e,null,[[0,5,10,13]])}))),$n.apply(this,arguments)}function zn(){return(zn=(0,a.Z)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Cn("rephrase",t,"Replace");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Wn(){return(Wn=(0,a.Z)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Cn("convert_to_table",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Jn(){return(Jn=(0,a.Z)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Cn("convert_to_flowchart",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Kn(){return(Kn=(0,a.Z)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Cn("convert_to_list",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Hn(){return(Hn=(0,a.Z)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Cn("convert_to_equation",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Xn(){return Xn=(0,a.Z)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Word.run(function(){var e=(0,a.Z)(o().mark((function e(n){var r,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=n.document.body.getComments()).load("items"),e.next=4,n.sync();case 4:for(a=r.items.length-1;a>=0;a--)r.items[a].delete();return e.next=7,n.sync();case 7:t.completed();case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)}))),Xn.apply(this,arguments)}function Yn(){return(Yn=(0,a.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.open("https://www.sally.bot/#contact","_blank");case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Office.onReady((0,a.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))),Office.actions.associate("help",(function(){return Yn.apply(this,arguments)})),Office.actions.associate("summarize",(function(e){return Nn.apply(this,arguments)})),Office.actions.associate("makeLonger",(function(e){return Zn.apply(this,arguments)})),Office.actions.associate("makeShorter",(function(e){return Un.apply(this,arguments)})),Office.actions.associate("contineWriting",(function(e){return Rn.apply(this,arguments)})),Office.actions.associate("refine",(function(e){return Mn.apply(this,arguments)})),Office.actions.associate("spellCheck",(function(e){return Dn.apply(this,arguments)})),Office.actions.associate("grammarCheck",(function(e){return Ln.apply(this,arguments)})),Office.actions.associate("addCitation",(function(e){return qn.apply(this,arguments)})),Office.actions.associate("review",(function(e){return Fn.apply(this,arguments)})),Office.actions.associate("correct",(function(e){return Bn.apply(this,arguments)})),Office.actions.associate("detect",(function(e){return $n.apply(this,arguments)})),Office.actions.associate("paraphrase",(function(e){return zn.apply(this,arguments)})),Office.actions.associate("removeAllComments",(function(e){return Xn.apply(this,arguments)})),Office.actions.associate("convertToTable",(function(e){return Wn.apply(this,arguments)})),Office.actions.associate("convertToFlowchart",(function(e){return Jn.apply(this,arguments)})),Office.actions.associate("convertToList",(function(e){return Kn.apply(this,arguments)})),Office.actions.associate("convertToEquation",(function(e){return Hn.apply(this,arguments)}))},98784:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{BB:function(){return isProd},XK:function(){return template},_v:function(){return sleep},dC:function(){return extractJsonDataFromMd}});var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(41915),_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__),marked__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(92584);function template(e,t){return e.replace(/\{\{(.*?)\}\}/g,(function(e,n){return t[n.trim()]||""}))}var extractCodeFromMd=function(e){if(!e)return"";if(!e.includes("```"))return e;var t=/```.*\n*([\s\S]*?)(```|$)/.exec(e);return t&&t[1]?t[1]:""},extractJsonDataFromMd=function(e){try{var t=e;return JSON.parse(t)}catch(t){var n,r=new marked__WEBPACK_IMPORTED_MODULE_1__.TU.Renderer,a=[];if(r.code=function(e,t,n){return a.push({code:e,infostring:t}),""},(0,marked__WEBPACK_IMPORTED_MODULE_1__.TU)(e,{renderer:r}),a.length>0)n=a[0].code.text;else{var i=/```(?:json)?\s*([\s\S]+?)\s*```/.exec(e);i&&i[1]&&(n=i[1])}try{return JSON.parse(n)}catch(e){return console.error("Error parsing JSON:",e),{}}}},extractToolJsonDataFromMd=function(e){try{return JSON.parse(e)}catch(i){var t=new marked.Renderer,n=[];t.code=function(e,t){return"tools"===(null==t?void 0:t.trim())&&n.push(e),""},marked(e,{renderer:t});var r=n.length>0?n[0]:null;if(!r){var a=/```tools\s*([\s\S]+?)\s*```/.exec(e);a&&a[1]&&(r=a[1])}if(r)try{return JSON.parse(r)}catch(e){console.error("Error parsing JSON from 'tools' block:",e)}return{}}},extractJsFunctionFromMd=function extractJsFunctionFromMd(inputText){var regex=/```.*\n([\s\S]+?)```/,match=regex.exec(inputText);if(match&&match[1]){var jsCode=match[1];try{var fun=eval("(function() {".concat(jsCode,"; \n return handleSheetData;})"));return fun()}catch(e){console.error("Error parsing JS:",e)}}return function(){throw new Error("No JS code found in the message")}},absolute=function(e){return"".concat(SHEET_CHAT_SITE).concat(e)},sleep=function(e){return new Promise((function(t){return setTimeout(t,e||500)}))},uuid=function(){return Date.now().toString(36)+Math.random().toString(36).substr(2,5)},isCtrlPlus=function(e,t){var n=navigator.platform.toUpperCase().indexOf("MAC")>=0;return n&&e.metaKey&&!e.ctrlKey&&!e.altKey&&e.key===t||!n&&e.ctrlKey&&!e.metaKey&&!e.altKey&&e.key===t},isProd=function(){return!0},memoize=function(e){var t=new Map;return function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];var i=JSON.stringify(r);if(t.has(i))return t.get(i);var o=e.apply(void 0,r);return t.set(i,o),o}},cacheInTime=function(e,t){var n={time:0,result:null};return function(){return Date.now()-n.time<t||(n.time=Date.now(),n.result=e.apply(void 0,arguments)),n.result}};function throttle(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300,n=!0;return function(){n&&(n=!1,e.apply(void 0,arguments),setTimeout((function(){n=!0}),t))}}var debounce=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300;return function(){for(var r=this,a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];t&&clearTimeout(t),t=setTimeout((function(){e.apply(r,i)}),n)}},blobToDataURL=null,_ref,blobToBase64=null,_ref2,blobToArrayBuffer=null,_ref3,blobToBase64Image=null,_ref4;function getMimeType(e){if(e.startsWith("http")){var t=e.split("?")[0],n=/\.[a-zA-Z0-9]+/g.exec(t);return n&&n.length>0?"image/".concat(n[0].substring(1)):"image/png"}var r=e.match(/^data:([a-zA-Z0-9]+\/[a-zA-Z0-9-+.]+);base64,/);return r&&r.length>1?r[1]:null}function base64ToBlob(e,t){for(var n=atob(e),r=new Uint8Array(n.length),a=0;a<n.length;a++)r[a]=n.charCodeAt(a);return new Blob([r],{type:t})}function base64ToFile(e,t,n){return _base64ToFile.apply(this,arguments)}function _base64ToFile(){return(_base64ToFile=_asyncToGenerator(_regeneratorRuntime.mark((function e(t,n,r){var a,i,o;return _regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=7;break}if(a=getMimeType(t)){e.next=5;break}return console.error("MIME"),e.abrupt("return",null);case 5:e.next=8;break;case 7:a=r;case 8:return i=t,t.startsWith("data:")&&(i=t.split(",")[1]),o=base64ToBlob(i,a),e.abrupt("return",new File([o],n,{type:a}));case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var platform=function(){var e,t;return void 0!==(null===(e=window)||void 0===e||null===(e=e.google)||void 0===e?void 0:e.script)?"google":void 0!==window.Office?"office":void 0!==window.Asc?"only":void 0!==(null===(t=window.chrome)||void 0===t?void 0:t.storage)?"chrome":"other"},copyTextByCommand=function(e,t){var n;"html"==e?(n=document.createElement("div")).innerHTML=t.trim():(n=document.createElement("textarea")).value=t.trim(),n.setAttribute("readonly",""),n.style.position="absolute",n.style.left="-99999px",document.body.appendChild(n);var r=document.createRange();r.selectNode(n);var a=document.getSelection();a.empty(),a.addRange(r),document.execCommand("copy"),document.body.removeChild(n)},copyByClipboard=null,_ref5;function extractMentions(e){for(var t,n=/@([^\s]+)/g,r=[];null!==(t=n.exec(e));)r.push(t[1].toLowerCase());return r}function removeMentions(e){return e.replace(/^@([^\s]+)/g,"").trim()}var extractCommand=function(e){var t=e.match(/^[/@]([^\s]+)/);return t?t[1]:""};function existMentions(e){return/^@([^\s]+)/g.test(e)}function arrayToMarkdownTable(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!Array.isArray(e)||0===e.length||!Array.isArray(e[0]))return"Invalid input. Please provide a non-empty 2D array.";var n=e[0],r=t?"| "+n.map((function(e){return(null==e?void 0:e.toString())||""})).join(" | ")+" |":"| "+n.map((function(e){return" "})).join(" | ")+" |",a="| "+Array.from({length:null==n?void 0:n.length},(function(){return" --- "})).join(" | ")+" |",i=e.slice(1).map((function(e){return"| "+e.map((function(e){return(null==e?void 0:e.toString())||""})).join(" | ")+" |"}));return[r,a].concat(_toConsumableArray(i)).join("\n")}function objectToHorizontalArray(e){var t=[];return t.push(Object.keys(e)),t.push(Object.values(e)),t}function isTwoDimensionalArray(e){return Array.isArray(e)&&e.length>0&&Array.isArray(e[0])}function capitalizeFirstLetter(e){return e?e.charAt(0).toUpperCase()+e.slice(1):e}function toggleClass(e,t){(arguments.length>2&&void 0!==arguments[2]?arguments[2]:document.body).classList[t?"add":"remove"](e)}function snakeToWords(e){var t=e.replace(/_/g," ");return t.replace(/\b\w/g,(function(e){return e.toUpperCase()}))}function formatNumber(e){if(e>=1e6){var t=e/1e6;return t%1==0?t+"M":t.toFixed(1)+"M"}if(e>=1e3){var n=e/1e3;return n%1==0?n+"K":n.toFixed(1)+"K"}return e.toString()}function formatCurrency(e){var t=e.toFixed(2).replace(/\.?0+$/,"");return"$".concat(t)}var formatNumberWithCommas=function(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")};function isBase64(e){return/^(?:[A-Za-z0-9+/]{4})*?(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}function adaptToolArguments(e){function t(e){return Array.isArray(e)?e.map((function(e){return Array.isArray(e)?e:t(e)})):e instanceof Object&&Object.prototype.hasOwnProperty.call(e,"Items")?e.Items?t(e.Items):[]:e instanceof Object?adaptToolArguments(e):e}for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&e[n]instanceof Object&&(e[n]=t(e[n]));return e}function flattenArray(e){return e.reduce((function(e,t){return Array.isArray(t)?e.concat(flattenArray(t)):e.concat(t)}),[])}function containsEmoji(e){return/(?:\||\uD83C[\uDDE0-\uDDFF\uDF00-\uDFFF]|\uD83D[\uDC00-\uDE4F\uDE80-\uDEFF])/.test(e)}var isMobile=function(){return"undefined"!=typeof document&&(document.body.clientWidth<768||/mobile|Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent))};function loadScript(e){return new Promise((function(t,n){var r=document.createElement("script");r.type="text/javascript",null!=r&&r.readyState?r.onreadystatechange=function(){"loaded"!=r.readyState&&"complete"!=r.readyState||(r.onreadystatechange=null,t(null))}:r.onload=function(){t(null)},r.src=e,document.getElementsByTagName("head")[0].appendChild(r)}))}function addBlockQuote(e){return e.trim()?e.replace(/^(.*)$/gm,"> $1"):""}function hexToRgba(e,t){if(!e)return"";t=Math.min(1,Math.max(0,t)),3===(e=e.replace("#","")).length&&(e=e.split("").map((function(e){return e+e})).join(""));var n=parseInt(e.substr(0,2),16),r=parseInt(e.substr(2,2),16),a=parseInt(e.substr(4,2),16);return"rgba(".concat(n,", ").concat(r,", ").concat(a,", ").concat(t,")")}var htmlToText=function(e){return(new DOMParser).parseFromString(e,"text/html").body.textContent||""}},77018:function(e,t,n){"use strict";n.r(t),t.default='Please provide a footnote in JSON format that includes the following details:\n\n- Authors: A list of authors with their last names and initials.\n- Year: The year of publication.\n- Title: The title of the publication.\n- URL: The URL where the publication can be accessed.\n- Journal (optional): The journal details including name, volume, and pages.\n\nCONSTRAINTS:\n\n- Ensure the URL is a valid URL.\n- IF the URL is not provided, use a empty string.\n\nThe JSON should conform to the following TypeScript interface:\n\n```typescript\nexport interface Author {\n  lastName: string;\n  initials: string;\n}\n\nexport interface Journal {\n  name?: string;\n  volume?: string;\n  pages?: string;\n}\n\nexport interface Footnote {\n  authors: Author[];\n  year: number;\n  title: string;\n  url: string;\n  journal?: Journal;\n}\n```\n\nExample JSON:\n\n```json\n{\n  "authors": [\n    {\n      "lastName": "Doe",\n      "initials": "J.D."\n    },\n    {\n      "lastName": "Smith",\n      "initials": "A.B."\n    }\n  ],\n  "year": 2021,\n  "title": "An Example Publication",\n  "journal": {\n    "name": "Example Journal",\n    "volume": "10",\n    "pages": "100-110"\n  }\n}\n```\n\nINPUT:\n{{input}}\n\nOUTPUT:\n'},49535:function(e,t,n){"use strict";n.r(t),t.default="Based on the content of user input, help me add appropriate emojis.\n\nINPUT:\n{{input}}\n\nOUTPUT:\n[Response in the language INPUT text ]\n"},94921:function(e,t,n){"use strict";n.r(t),t.default="# Role Definition\n\nYou are a professional academic writing assistant, specialized in paper continuation, refinement, and logical optimization.\n\n## Continuation Task Requirements\n\n1. Accurately capture the original text's academic style and language characteristics\n2. Maintain the logical coherence of the paper\n3. Ensure precise and standardized academic terminology\n4. Pay attention to smooth transitions between paragraphs\n5. Adhere to the objective and neutral principles of academic writing\n\n## Pre-Continuation Analysis Steps\n\n1. Carefully read the existing text to understand:\n\n   - Paper topic\n   - Research objectives\n   - Core arguments of current reasoning\n   - Logical structure\n   - Discipline-specific characteristics\n\n2. Identify the text's:\n   - Writing style\n   - Professional terminology\n   - Argumentative structure\n   - Citation practices\n\n## Continuation Guidance Principles\n\n- Maintain academic rigor\n- Use concise language, avoid redundancy\n- Provide well-supported arguments\n- Appropriately use professional terminology\n- Ensure logical progression and connectivity\n\n## Continuation Template Suggestions\n\n1. Argument exposition\n2. Evidence support\n3. Logical reasoning\n4. Mini-conclusion or transition\n\n## Prohibited Actions\n\n- Do not deviate from the original text's theme\n- Do not arbitrarily add content unrelated to the topic\n- Avoid subjective speculation\n- Eliminate grammatical and expression errors\n\n## Output Format Requirements\n\n- Use standard academic paper formatting\n- Maintain complete paragraph structure\n- Mark sections that may require citations\n\nINPUT:\n{{input}}\n\nOUTPUT:\n[Response in the language INPUT text ]\n"},23230:function(e,t,n){"use strict";n.r(t),t.default='You need to help me convert the text user input to the Formula in Latex format,\n\nMATHEMATICAL EXPRESSION FORMATTING:\n\nPlease express all mathematical formulas in LaTeX format, enclosed in either single dollar signs ($) for inline formulas or double dollar signs ($$) for display formulas. For example:\n\n- Use $x^2 + y^2 = r^2$ for inline equations\n- Use $$\\int_0^\\infty e^{-x^2} dx = \\frac{\\sqrt{\\pi}}{2}$$ for displayed equations\n\nPlease maintain proper LaTeX syntax including:\n\n- Use proper fractions with \\frac{numerator}{denominator}\n- Use \\sqrt{} for square roots\n- Use proper subscripts with \\_ and superscripts with ^\n- Use \\sum, \\prod, \\int for summation, product and integral symbols\n- Include proper spacing with \\space or ;\n- Use \\left( and \\right) for dynamic parentheses sizing"\n\nINPUT:\n{{input}}\n\nOUTPUT:\n[Response in the language INPUT text ]\n'},76150:function(e,t,n){"use strict";n.r(t),t.default="help me create flowchat based on follow text using mermaid.\n\nINPUT:\n{{input}}\n\nOUTPUT:\n[Response in the language INPUT text ]\n"},97682:function(e,t,n){"use strict";n.r(t),t.default="You need to help me visualize follow text in a list format or create a list based on the input text.\n\nINPUT:\n{{input}}\n\nOUTPUT:\n[Response in the language INPUT text ]\n"},59259:function(e,t,n){"use strict";n.r(t),t.default="You need to help me visualize the following text in a table format or create a table based on the input text.\n\nINPUT:\n{{input}}\n\nOUTPUT:\n[Response in the language INPUT text ]\n"},59207:function(e,t,n){"use strict";n.r(t),t.default='You are an AI Proofreading Assistant designed to review and annotate text for spelling, grammar, and language improvements.\n\nYour task is to:\n\n1. Carefully analyze the input text\n2. Identify spelling and grammar errors\n3. Provide constructive suggestions for improvement\n4. Return findings in a structured JSON format\n\nRules:\n\n- Preserve the original text\'s meaning and style\n- Focus on clear, actionable feedback\n- Include the original problematic word/sentence\n- Explain suggested corrections\n\nINPUT:\n{{input}}\n\nOUTPUT:\n\n```json\n{\n  "comments": [\n    {\n      "original": "Original word or sentence",\n      "corrected": "Corrected word or sentence",\n      "suggestion": "Specific improvement recommendation",\n      "type": "spelling/grammar/clarity/style"\n    }\n  ]\n}\n```\n'},82397:function(e,t,n){"use strict";n.r(t),t.default=""},34694:function(e,t,n){"use strict";n.r(t),t.default='Carefully analyze the following text, evaluating its potential AI-generated nature across multiple dimensions:\n\n1. Language Feature Analysis:\n\n- Check if the text lacks personal style and appears overly standardized\n- Analyze sentence structure for excessive uniformity\n- Assess vocabulary diversity and uniqueness\n\n2. Coherence and Logical Flow Detection:\n\n- Evaluate overall logical coherence\n- Identify any abrupt argument transitions\n- Analyze depth and unique insights\n\n3. Semantic and Emotional Characteristics:\n\n- Determine absence of genuine personal emotion\n- Check for overly neutral and objective expressions\n- Assess authenticity and nuance of emotional content\n\n4. Technical Feature Identification:\n\n- Detect typical AI-generated text patterns\n- Analyze sentence length and structural uniformity\n- Identify potential AI writing markers\n\nOutput Results:\n\n- Sentences with potential AI-generated content from the text\n- Percentage of AI generation probability\n- Specific features supporting the assessment\n- Confidence level explanation\n- Output explanation using the language of the input text\n\nINPUT:\n{{input}}\n\nOUTPUT:\n\n```json\n{\n  "comments": [\n    {\n      "sentences": "<sentences>",\n      "explanation": "probability:0.95, features:<features>, suggestions:<suggestions>"\n    }\n  ]\n}\n```\n'},70437:function(e,t,n){"use strict";n.r(t),t.default="Please convert the following text into well-formatted Markdown, following these rules:\n\n1. Add appropriate heading levels (#) for titles (h1-h6)\n2. Mark important content with **bold**\n3. Mark emphasized content with _italics_\n4. Properly format lists (ordered and unordered)\n5. Add blockquotes (>) where appropriate\n6. Properly format code blocks (using ```)\n7. Use correct Markdown syntax for links and images\n8. Use horizontal rules (---) to separate different sections\n9. Format mathematical expressions using LaTeX syntax:\n   - Inline math with single $ ($formula$)\n   - Display math with double $$ ($$formula$$)\n10. Format diagrams using Mermaid syntax:\n    ```mermaid\n    [diagram code]\n    ```\n11. Maintain proper spacing between paragraphs\n12. Ensure overall clarity and readability\n13. Outputs Markdown directly, without wrapping it in ```\n\nINPUT:\n{{input}}\n\nOUTPUT:\n"},48848:function(e,t,n){"use strict";n.r(t),t.default="Review the following text and provide only the corrected version. Fix any spelling errors, grammar mistakes, punctuation issues, and improve clarity while maintaining the original meaning. Do not explain the corrections or provide additional feedback.\n\nINPUT:\n{{input}}\n\nOUTPUT:\n"},78921:function(e,t,n){"use strict";n.r(t),t.default="You are Sally, an AI assistant integrated as a plugin for PowerPoint. Your role is to help users create, edit, and enhance their presentations.\n\nCAPABILITIES:\n\n- You can access and analyze the text and slides the user has selected.\n- You can provide suggestions for design, content, and structure improvements.\n- You can explain PowerPoint features and how to use them effectively.\n\nTOOL EVALUATION:\n\n- Before calling any tool, evaluate if it's absolutely necessary for the task\n- Only use tools explicitly listed in the tool description\n- Verify the tool's relevance to the current request\n- If in doubt, prefer not to call a tool\n- If User attach file content in message, directly call `generate_presentation` tool\n\nTOOL EXECUTION RULES:\n\n- Call maximum one tool per response\n- Use tools only when:\n  - The task specifically requires tool functionality\n  - Manual suggestions alone cannot achieve the desired outcome\n  - The tool's description directly matches the user's request\n- Never experiment with tools or call them \"just to see what happens\"\n\nMATHEMATICAL EXPRESSION FORMATTING:\n\nPlease express all mathematical formulas in LaTeX format, enclosed in either single dollar signs ($) for inline formulas or double dollar signs ($$) for display formulas. For example:\n\n- Use $x^2 + y^2 = r^2$ for inline equations\n- Use $$\\int_0^\\infty e^{-x^2} dx = \\frac{\\sqrt{\\pi}}{2}$$ for displayed equations\n\nPlease maintain proper LaTeX syntax including:\n\n- Use proper fractions with \\frac{numerator}{denominator}\n- Use \\sqrt{} for square roots\n- Use proper subscripts with \\_ and superscripts with ^\n- Use \\sum, \\prod, \\int for summation, product and integral symbols\n- Include proper spacing with \\space or ;\n- Use \\left( and \\right) for dynamic parentheses sizing\"\n\nINTERACTION GUIDELINES:\n\n- Communicate in a friendly, professional manner.\n- If you need more information to assist the user, ask clarifying questions.\n- Provide step-by-step instructions when explaining how to perform tasks in PowerPoint.\n- Offer creative suggestions to enhance the visual appeal and effectiveness of presentations.\n- If a user's request is unclear or outside your capabilities, politely ask for clarification or explain your limitations.\n\nRemember, your goal is to help users create impressive and effective PowerPoint presentations while providing a smooth and intuitive assistance experience.\n"},21937:function(e,t,n){"use strict";n.r(t),t.default="\n[](https://img2.pconline.com.cn/pconline/0706/07/1031072_070611dog33.jpg)\n$F2O2$\n\n```mermaid\nflowchart LR\n    Start --\x3e Stop\n```\n\n```mermaid\nsequenceDiagram\n    Alice->>John: Hello John, how are you?\n    John--\x3e>Alice: Great!\n    Alice-)John: See you later!\n\n```\n\n```mermaid\nstateDiagram\n    [*] --\x3e Still\n    Still --\x3e [*]\n\n    Still --\x3e Moving\n    Moving --\x3e Still\n    Moving --\x3e Crash\n    Crash --\x3e [*]\n\n```\n\n| name  | age | gender |\n| ----- | --- | ------ |\n| sally | 20  | female |\n| eric  | 30  | male   |\n"},91868:function(e,t,n){"use strict";n.r(t),t.default="# Text Expansion Assistant\n\nYou are a specialized text expansion assistant. Your task is to enhance and expand text while maintaining its original essence and adding meaningful detail.\n\n## Core Objectives\n\n1. Expand the specified text with rich details and vivid descriptions\n2. Preserve the original message and tone\n3. Ensure logical flow and coherence\n4. Match the input language in responses\n\n## Expansion Guidelines\n\n### Content Enhancement\n\n- Add relevant sensory details (visual, auditory, tactile)\n- Include specific examples and illustrations\n- Incorporate appropriate emotional elements\n- Expand abstract concepts with concrete details\n- Add relevant context and background information\n\n### Style Requirements\n\n- Match the original text's tone (formal/informal)\n- Maintain consistent voice and perspective\n- Use varied sentence structures for better rhythm\n- Ensure smooth transitions between ideas\n- Preserve any specialized terminology or jargon\n\n### Structural Rules\n\n- Organize content in logical paragraphs\n- Use appropriate headings when needed\n- Maintain proper text hierarchy\n- Ensure proportional expansion of ideas\n- Create clear topic sentences and supporting details\n\n### Language Requirements\n\n- Match the input language perfectly\n- Preserve any cultural nuances\n- Maintain appropriate formality level\n- Use region-specific expressions if present\n- Keep technical terminology consistent\n\n### Mathematical Expression Formatting\n\nUse LaTeX formatting for all mathematical expressions:\n\n- Inline formulas: $formula$ (e.g., $x^2 + y^2 = r^2$)\n- Display formulas: $$formula$$ (e.g., $$\\int_0^\\infty e^{-x^2} dx = \\frac{\\sqrt{\\pi}}{2}$$)\n\nLaTeX Syntax Rules:\n\n- Fractions: \\frac{numerator}{denominator}\n- Square roots: \\sqrt{expression}\n- Subscripts: x_1\n- Superscripts: x^2\n- Special symbols: \\sum, \\prod, \\int\n- Proper spacing: \\space or ;\n- Dynamic parentheses: \\left( and \\right)\n\n## Quality Control Checklist\n\n- [ ] Content is substantively expanded\n- [ ] Original meaning is preserved\n- [ ] Style matches source text\n- [ ] Language consistency maintained\n- [ ] Mathematical expressions properly formatted\n- [ ] Logical flow is coherent\n- [ ] Grammar and syntax are correct\n- [ ] Cultural sensitivity maintained\n\n## Output Format\n\nOnly output the expanded text, maintaining:\n\n- Original paragraph structure\n- Source text formatting\n- Mathematical expression standards\n- Language consistency\n\nINPUT: {{input}}\n\nOUTPUT:\n[Response in the language INPUT text]\n"},45942:function(e,t,n){"use strict";n.r(t),t.default="# Academic Paper Shortening Assistant Guidelines\n\n## Role Definition\n\nProfessional academic paper refinement assistant, skilled at compressing text while retaining core information\n\n## Reduction Principles\n\n1. Preserve the paper's core arguments and key information\n2. Remove redundant expressions and repetitive content\n3. Streamline language and improve expression efficiency\n4. Maintain the original text's academic rigor\n5. Preserve the original logical coherence\n\n## Specific Reduction Strategies\n\n- Delete:\n\n  1. Repeated discussions\n  2. Secondary details\n  3. Overly elaborate explanations\n  4. Dispensable modifiers\n\n- Retain:\n  1. Core arguments\n  2. Key research findings\n  3. Core methodology\n  4. Major conclusions\n\n## Shortening Techniques\n\n1. Use more concise expressions\n2. Convert long sentences to short ones\n3. Remove unnecessary adjectives\n4. Replace lengthy descriptions with precise academic terms\n\n## Output Requirements\n\n- Maintain the original academic style\n- Compress text by 20%-40%\n- Ensure the original intent remains unchanged\n- Preserve academic professionalism\n\nOutput Shorten Text.\n\nINPUT:\n{{input}}\n\nOUTPUT:\n[Response in the language INPUT text]\n"},73830:function(e,t,n){"use strict";n.r(t),t.default="Please generate five distinct titles based on the article content, ensuring they reflect various aspects of the article and are captivating.\n\nAnswer in the same language as the text entered by the user.\n\nINPUT:\n{{input}}\n\nOUTPUT:\n[Response in the language INPUT text]\n"},75088:function(e,t,n){"use strict";n.r(t),t.default="Role: Academic Writing Assistant specializing in Text Refinement\n\nRefinement Objectives:\n\n- Elevate academic writing quality\n- Enhance scholarly precision\n- Optimize linguistic expression\n- Maintain original research intent\n\nRefinement Guidelines:\n\n1. Linguistic Enhancement\n\n- Improve sentence structure\n- Select more precise academic vocabulary\n- Eliminate redundancy\n- Ensure grammatical elegance\n\n2. Academic Rigor\n\n- Preserve original research logic\n- Maintain objective tone\n- Align with disciplinary writing standards\n- Enhance argumentative clarity\n\n3. Stylistic Optimization\n\n- Adjust to appropriate academic register\n- Balance formal language with readability\n- Remove colloquial expressions\n- Ensure consistent scholarly voice\n\n4. Technical Considerations\n\n- Check terminology accuracy\n- Verify disciplinary-specific language use\n- Align with citation guidelines\n- Ensure conceptual consistency\n\nRefinement Constraints:\n\n- Do not alter core research arguments\n- Avoid introducing new content\n- Maintain original author's intellectual intent\n- Focus on linguistic and structural improvement\n\nProcessing Steps:\n\n1. Comprehensive text analysis\n2. Identify improvement areas\n3. Execute targeted refinements\n4. Validate against academic standards\n\nOutput Refined Text.\n\nINPUT:\n{{input}}\n\nOUTPUT:\n[Response in the language INPUT text]\n"},5817:function(e,t,n){"use strict";n.r(t),t.default="Role: Academic Paraphrasing Assistant\n\nCore Objectives:\n\n- Preserve original meaning\n- Enhance clarity\n- Maintain academic integrity\n- Optimize scholarly expression\n\nParaphrasing Guidelines:\n\n1. Semantic Preservation\n\n- Retain core research argument\n- Maintain original intellectual intent\n- Ensure 100% conceptual fidelity\n- Avoid misrepresentation\n\n2. Linguistic Transformation\n\n- Restructure sentence composition\n- Replace vocabulary strategically\n- Alter grammatical architecture\n- Use discipline-specific terminology\n\n3. Stylistic Considerations\n\n- Match target academic register\n- Ensure consistent scholarly tone\n- Eliminate colloquial expressions\n- Align with publication standards\n\n4. Advanced Techniques\n\n- Synthesize complex ideas concisely\n- Introduce nuanced academic phrasing\n- Balance complexity and readability\n- Leverage disciplinary discourse conventions\n\nParaphrasing Constraints:\n\n- No content addition\n- No meaning distortion\n- Maintain original citation context\n- Respect intellectual ownership\n\nProcessing Protocol:\n\n1. Comprehensive semantic analysis\n2. Identify transformation strategies\n3. Execute precise linguistic reconfiguration\n4. Validate conceptual alignment\n\nMandatory Paraphrased Text.\n\nINPUT:\n{{input}}\n\nOUTPUT:\n[Response in the language INPUT text]\n"},83583:function(e,t,n){"use strict";n.r(t),t.default='You are an AI Proofreading Assistant designed to review and annotate text for spelling, grammar, and language improvements.\n\nYour task is to:\n\n1. Carefully analyze the input text\n2. Identify spelling and grammar errors\n3. Provide constructive suggestions for improvement\n4. Return findings in a structured JSON format\n\nRules:\n\n- Preserve the original text\'s meaning and style\n- Focus on clear, actionable feedback\n- Include the original problematic word/sentence\n- Explain suggested corrections\n\nINPUT:\n{{input}}\n\nOUTPUT:\n\n```json\n{\n  "comments": [\n    {\n      "original": "Original word or sentence",\n      "suggestion": "Specific improvement recommendation",\n      "type": "spelling/grammar/clarity/style"\n    }\n  ]\n}\n```\n'},25889:function(e,t,n){"use strict";n.r(t),t.default=""},87342:function(e,t,n){"use strict";n.r(t),t.default='You are a professional spelling checker specializing in document review. Your task is to improve spelling accuracy while maintaining the original text\'s integrity.\n\nPlease:\n\n1. Correct only spelling errors\n2. Do NOT modify grammar or punctuation\n3. Preserve the original meaning and terminology\n4. Keep the same language as the input text\n5. Maintain the original text\'s style and structure\n\nIf the text contains technical terms or specialized vocabulary, preserve them exactly as they are.\n\nINPUT:\n{{input}}\n\nOUTPUT:\n\n```json\n{\n  "comments": [\n    {\n      "original": "Original word",\n      "corrected": "Corrected word",\n      "type": "spelling"\n    }\n  ]\n}\n```\n'},14346:function(e,t,n){"use strict";n.r(t),t.default='You are an AI Sentence-Level Proofreading Assistant designed to review and annotate text with a focus on sentence-level improvements.\n\nYour task is to:\n\n1. Carefully analyze each sentence in the input text\n2. Identify sentence-level issues including spelling, grammar, structure, coherence, and clarity\n3. Provide constructive suggestions for improving entire sentences\n4. Return findings in a structured JSON format\n\nRules:\n\n- Preserve the original text\'s core meaning and intended communication\n- Focus on holistic sentence improvement\n- Provide context for each sentence improvement\n- Explain suggested corrections at the sentence level\n\nINPUT:\n{{input}}\n\nOUTPUT:\n\n```json\n{\n  "comments": [\n    {\n      "original": "Complete original sentence",\n      "corrected": "Improved complete sentence",\n      "suggestion": "Comprehensive sentence improvement recommendation",\n      "type": "structure/clarity/coherence/grammar"\n    }\n  ]\n}\n```\n'},22666:function(e,t,n){"use strict";n.r(t),t.default="# Email Summary Template\n\nPlease analyze this email and provide:\n\n## Basic Info:\n\n- From/To\n- Subject\n- Date\n\n## Main Points:\n\n- Core message\n- Action items (if any)\n- Deadlines (if any)\n\n## Required Follow-up:\n\n- Response needed?\n- Next steps?\n\n## Summary:\n\nPlease summarize the core content of this email in 1-2 sentences.\n\n---\n\nEMAIL HISTORY:\n\n{{input}}\n\nOUTPUT:\n[Response in the language {{language}}]\n"},33736:function(e,t,n){"use strict";n.r(t),t.default="# Role Definition\n\nProfessional academic summary expert skilled in extracting core paper information and presenting it concisely\n\n## Summary Generation Objectives\n\n1. Accurately reflect the original text's core content\n2. Highlight research significance\n3. Clearly communicate research purpose, methods, results, and conclusions\n4. Maintain academic professionalism\n5. Follow academic summary writing standards\n\n## Summary Structure Requirements\n\n1. Research background/Problem statement\n2. Research purpose\n3. Research methodology\n4. Key findings\n5. Main conclusions\n6. Research significance (optional)\n\n## Summary Writing Principles\n\n- Maintain objectivity and neutrality\n- Use third-person perspective\n- Avoid subjective comments\n- Do not introduce new information\n- Focus on the paper's core content\n\n## Language Requirements\n\n1. Use academic professional terminology\n2. Be concise\n3. Ensure logical clarity\n4. Avoid abbreviations and acronyms\n5. Use direct and clear sentence structures\n\n## Word Count Control\n\n- Chinese summary: 300-500 characters\n- English summary: 150-250 words\n\n## Output Format\n\n- Single paragraph presentation\n- Avoid reference citations\n- No inclusion of figures/tables\n- Emphasize research innovation\n\n## Evaluation Criteria\n\n1. Information completeness\n2. Logical coherence\n3. Linguistic precision\n4. Professionalism\n5. Readability\n\nINPUT:\n{{input}}\n\nOUTPUT:\n[Response in the language INPUT text]\n"},58695:function(e,t,n){var r={"./prompt/add_citation.md":77018,"./prompt/add_emoji.md":49535,"./prompt/contine_write.md":94921,"./prompt/convert_to_equation.md":23230,"./prompt/convert_to_flowchart.md":76150,"./prompt/convert_to_list.md":97682,"./prompt/convert_to_table.md":59259,"./prompt/correct_comment.md":59207,"./prompt/create_images.md":82397,"./prompt/detect.md":34694,"./prompt/format_text.md":70437,"./prompt/grammar_check.md":48848,"./prompt/instruction.md":78921,"./prompt/introduction.md":21937,"./prompt/make_longer.md":91868,"./prompt/make_shorter.md":45942,"./prompt/make_titles.md":73830,"./prompt/refine.md":75088,"./prompt/rephrase.md":5817,"./prompt/review_comment.md":83583,"./prompt/search_images.md":25889,"./prompt/spell_check.md":87342,"./prompt/spell_grammar.md":14346,"./prompt/summarize-email.md":22666,"./prompt/summarize.md":33736};function a(e){var t=i(e);return n(t)}function i(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}a.keys=function(){return Object.keys(r)},a.resolve=i,e.exports=a,a.id=58695},87363:function(e){"use strict";e.exports=React}},__webpack_module_cache__={},deferred,inProgress,dataWebpackPrefix;function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(n.exports,n,n.exports,__webpack_require__),n.exports}__webpack_require__.m=__webpack_modules__,deferred=[],__webpack_require__.O=function(e,t,n,r){if(!t){var a=1/0;for(c=0;c<deferred.length;c++){t=deferred[c][0],n=deferred[c][1],r=deferred[c][2];for(var i=!0,o=0;o<t.length;o++)(!1&r||a>=r)&&Object.keys(__webpack_require__.O).every((function(e){return __webpack_require__.O[e](t[o])}))?t.splice(o--,1):(i=!1,r<a&&(a=r));if(i){deferred.splice(c--,1);var s=n();void 0!==s&&(e=s)}}return e}r=r||0;for(var c=deferred.length;c>0&&deferred[c-1][2]>r;c--)deferred[c]=deferred[c-1];deferred[c]=[t,n,r]},__webpack_require__.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=function(e,t){for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.f={},__webpack_require__.e=function(e){return Promise.all(Object.keys(__webpack_require__.f).reduce((function(t,n){return __webpack_require__.f[n](e,t),t}),[]))},__webpack_require__.u=function(e){return e+"."+{156:"0508e921cbd65c823634",645:"6d8ccf2530c433d121d9",898:"f1c910430dd75eb36e9b"}[e]+".js"},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},inProgress={},dataWebpackPrefix="office-chat:",__webpack_require__.l=function(e,t,n,r){if(inProgress[e])inProgress[e].push(t);else{var a,i;if(void 0!==n)for(var o=document.getElementsByTagName("script"),s=0;s<o.length;s++){var c=o[s];if(c.getAttribute("src")==e||c.getAttribute("data-webpack")==dataWebpackPrefix+n){a=c;break}}a||(i=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,__webpack_require__.nc&&a.setAttribute("nonce",__webpack_require__.nc),a.setAttribute("data-webpack",dataWebpackPrefix+n),a.src=e),inProgress[e]=[t];var u=function(t,n){a.onerror=a.onload=null,clearTimeout(l);var r=inProgress[e];if(delete inProgress[e],a.parentNode&&a.parentNode.removeChild(a),r&&r.forEach((function(e){return e(n)})),t)return t(n)},l=setTimeout(u.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=u.bind(null,a.onerror),a.onload=u.bind(null,a.onload),i&&document.head.appendChild(a)}},__webpack_require__.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.p="/office-chat/doc-commands/",function(){var e={400:0};__webpack_require__.f.j=function(t,n){var r=__webpack_require__.o(e,t)?e[t]:void 0;if(0!==r)if(r)n.push(r[2]);else{var a=new Promise((function(n,a){r=e[t]=[n,a]}));n.push(r[2]=a);var i=__webpack_require__.p+__webpack_require__.u(t),o=new Error;__webpack_require__.l(i,(function(n){if(__webpack_require__.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var a=n&&("load"===n.type?"missing":n.type),i=n&&n.target&&n.target.src;o.message="Loading chunk "+t+" failed.\n("+a+": "+i+")",o.name="ChunkLoadError",o.type=a,o.request=i,r[1](o)}}),"chunk-"+t,t)}},__webpack_require__.O.j=function(t){return 0===e[t]};var t=function(t,n){var r,a,i=n[0],o=n[1],s=n[2],c=0;if(i.some((function(t){return 0!==e[t]}))){for(r in o)__webpack_require__.o(o,r)&&(__webpack_require__.m[r]=o[r]);if(s)var u=s(__webpack_require__)}for(t&&t(n);c<i.length;c++)a=i[c],__webpack_require__.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return __webpack_require__.O(u)},n=self.webpackChunkoffice_chat=self.webpackChunkoffice_chat||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var __webpack_exports__=__webpack_require__.O(void 0,[233],(function(){return __webpack_require__(65619)}));__webpack_exports__=__webpack_require__.O(__webpack_exports__)})();